<!doctype html><!-- This site was created with Hugo Blox. https://hugoblox.com --><!-- Last Published: December 14, 2024 --><html lang=en-us dir=ltr data-wc-theme-default=light><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=generator content="Hugo Blox Builder 0.2.0"><meta name=description content="THE PBDW method
import sys
!{sys.executable} -m pip install numpy
!{sys.executable} -m pip install matplotlib
!{sys.executable} -m pip install scikit-fem
Let us present one method that combines model order reduction and a data assimilation problem: the Parametrized-Background Data-Weak method (PBDW).
$$ G^{bk,\mu}(u^{bk}(\mu)) = 0.$$$$ \mathcal{M}^{bk} = \{u^{bk}(\mu) : \mu \in \mathcal{P}^{bk}\}.$$The PBDW formulation integrates the parameterized mathematical model $G^{pb}$ and $M$ experimental observations associated with a parameter configuration $\mu^{true}$ to estimate the true field $u^{true}(\mu^{true})$ as well as any desired output $l_{out}(u^{true}(\mu^{true}\
)) \in \mathbb{R}$ for given output functional $l_{out}$.                                                                                                               
We intend that $\lVert u^{true}(\mu^{true})-u^{bk}(\mu^{true}) \rVert$ is small (i.e. that our model represents our data observations well)."><link rel=alternate hreflang=en-us href=https://reducedbasis.github.io/post/pbdwadv/><link rel=stylesheet href=/css/themes/blue.min.css><link href=/dist/wc.min.css rel=stylesheet><script>window.hbb={defaultTheme:document.documentElement.dataset.wcThemeDefault,setDarkTheme:()=>{document.documentElement.classList.add("dark"),document.documentElement.style.colorScheme="dark"},setLightTheme:()=>{document.documentElement.classList.remove("dark"),document.documentElement.style.colorScheme="light"}},console.debug(`Default Hugo Blox Builder theme is ${window.hbb.defaultTheme}`),"wc-color-theme"in localStorage?localStorage.getItem("wc-color-theme")==="dark"?window.hbb.setDarkTheme():window.hbb.setLightTheme():(window.hbb.defaultTheme==="dark"?window.hbb.setDarkTheme():window.hbb.setLightTheme(),window.hbb.defaultTheme==="system"&&(window.matchMedia("(prefers-color-scheme: dark)").matches?window.hbb.setDarkTheme():window.hbb.setLightTheme()))</script><script>document.addEventListener("DOMContentLoaded",function(){let e=document.querySelectorAll("li input[type='checkbox'][disabled]");e.forEach(e=>{e.parentElement.parentElement.classList.add("task-list")});const t=document.querySelectorAll(".task-list li");t.forEach(e=>{let t=Array.from(e.childNodes).filter(e=>e.nodeType===3&&e.textContent.trim().length>1);if(t.length>0){const n=document.createElement("label");t[0].after(n),n.appendChild(e.querySelector("input[type='checkbox']")),n.appendChild(t[0])}})})</script><link rel=icon type=image/png href=/media/icon_hu16304263275779960481.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu1534112029185156839.png><link rel=canonical href=https://reducedbasis.github.io/post/pbdwadv/><meta property="twitter:card" content="summary"><meta property="twitter:site" content="@GetResearchDev"><meta property="twitter:creator" content="@GetResearchDev"><meta property="og:site_name" content="RBM Docs"><meta property="og:url" content="https://reducedbasis.github.io/post/pbdwadv/"><meta property="og:title" content="RBM Docs"><meta property="og:description" content="THE PBDW method
import sys
!{sys.executable} -m pip install numpy
!{sys.executable} -m pip install matplotlib
!{sys.executable} -m pip install scikit-fem
Let us present one method that combines model order reduction and a data assimilation problem: the Parametrized-Background Data-Weak method (PBDW).
$$ G^{bk,\mu}(u^{bk}(\mu)) = 0.$$$$ \mathcal{M}^{bk} = \{u^{bk}(\mu) : \mu \in \mathcal{P}^{bk}\}.$$The PBDW formulation integrates the parameterized mathematical model $G^{pb}$ and $M$ experimental observations associated with a parameter configuration $\mu^{true}$ to estimate the true field $u^{true}(\mu^{true})$ as well as any desired output $l_{out}(u^{true}(\mu^{true}\
)) \in \mathbb{R}$ for given output functional $l_{out}$.                                                                                                               
We intend that $\lVert u^{true}(\mu^{true})-u^{bk}(\mu^{true}) \rVert$ is small (i.e. that our model represents our data observations well)."><meta property="og:image" content="https://reducedbasis.github.io/media/icon_hu8177510199143947247.png"><meta property="twitter:image" content="https://reducedbasis.github.io/media/icon_hu8177510199143947247.png"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2024-12-13T10:19:20+01:00"><meta property="article:modified_time" content="2024-12-13T10:19:20+01:00"><title>RBM Docs</title><style>@font-face{font-family:inter var;font-style:normal;font-weight:100 900;font-display:swap;src:url(/dist/font/Inter.var.woff2)format(woff2)}</style><link type=text/css rel=stylesheet href=/dist/pagefind/pagefind-ui.be766eb419317a14ec769d216e9779bfe8f3737c80e780f4ba0dafb57a41a482.css integrity="sha256-vnZutBkxehTsdp0hbpd5v+jzc3yA54D0ug2vtXpBpII="><script src=/dist/pagefind/pagefind-ui.87693d7c6f2b3b347ce359d0ede762c033419f0a32b22ce508c335a81d841f1b.js integrity="sha256-h2k9fG8rOzR841nQ7ediwDNBnwoysizlCMM1qB2EHxs="></script><script>window.hbb.pagefind={baseUrl:"/"}</script><style>html.dark{--pagefind-ui-primary:#eeeeee;--pagefind-ui-text:#eeeeee;--pagefind-ui-background:#152028;--pagefind-ui-border:#152028;--pagefind-ui-tag:#152028}</style><script>window.addEventListener("DOMContentLoaded",e=>{new PagefindUI({element:"#search",showSubResults:!0,baseUrl:window.hbb.pagefind.baseUrl,bundlePath:window.hbb.pagefind.baseUrl+"pagefind/"})}),document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementById("search"),t=document.getElementById("search_toggle");t&&t.addEventListener("click",()=>{if(e.classList.toggle("hidden"),e.querySelector("input").value="",e.querySelector("input").focus(),!e.classList.contains("hidden")){let t=document.querySelector(".pagefind-ui__search-clear");t&&!t.hasAttribute("listenerOnClick")&&(t.setAttribute("listenerOnClick","true"),t.addEventListener("click",()=>{e.classList.toggle("hidden")}))}})})</script><link type=text/css rel=stylesheet href=/dist/lib/katex/katex.min.505d5f829022bb7b4f24dfee0aa1141cd7bba67afe411d1240335f820960b5c3.css integrity="sha256-UF1fgpAiu3tPJN/uCqEUHNe7pnr+QR0SQDNfgglgtcM="><script defer src=/dist/lib/katex/katex.min.dc84b296ec3e884de093158f760fd9d45b6c7abe58b5381557f4e138f46a58ae.js integrity="sha256-3ISyluw+iE3gkxWPdg/Z1Ftser5YtTgVV/ThOPRqWK4="></script><script defer src=/js/katex-renderer.6579ec9683211cfb952064aedf3a3baea5eeb17a061775b32b70917474637c80.js integrity="sha256-ZXnsloMhHPuVIGSu3zo7rqXusXoGF3WzK3CRdHRjfIA="></script><script defer src=/js/hugo-blox-en.min.e5fa931947cac2d947732ea37a770aae2b5bd4a50b6048060cd129b46159a06d.js integrity="sha256-5fqTGUfKwtlHcy6jencKritb1KULYEgGDNEptGFZoG0="></script></head><body class="dark:bg-hb-dark dark:text-white page-wrapper" id=top><div id=page-bg></div><div class="page-header sticky top-0 z-30"><header id=site-header class=header><nav class="navbar px-3 flex justify-left"><div class="order-0 h-100"><a class=navbar-brand href=/ title="RBM Docs"><img fetchpriority=high decoding=async width=49 height=36 src=/media/logo_hu9071661120962382538.webp alt="RBM Docs"></a></div><input id=nav-toggle type=checkbox class=hidden>
<label for=nav-toggle class="order-3 cursor-pointer flex items-center lg:hidden text-dark dark:text-white lg:order-1"><svg id="show-button" class="h-6 fill-current block" viewBox="0 0 20 20"><title>Open Menu</title><path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0V0z"/></svg><svg id="hide-button" class="h-6 fill-current hidden" viewBox="0 0 20 20"><title>Close Menu</title><polygon points="11 9 22 9 22 11 11 11 11 22 9 22 9 11 -2 11 -2 9 9 9 9 -2 11 -2" transform="rotate(45 10 10)"/></svg></label><ul id=nav-menu class="navbar-nav order-3 hidden lg:flex w-full pb-6 lg:order-1 lg:w-auto lg:space-x-2 lg:pb-0 xl:space-x-8 justify-left"><li class=nav-item><a class=nav-link href=/>Home</a></li><li class=nav-item><a class=nav-link href=/docs/>Documentation</a></li><li class=nav-item><a class=nav-link href=/blog/>News</a></li><li class=nav-item><a class=nav-link href=/showcase/>Other examples</a></li><li class=nav-item><a class=nav-link href=/events/>Events</a></li><li class="mt-4 inline-block lg:hidden"><a href=/>Get Started</a></li></ul><div class="order-1 ml-auto flex items-center md:order-2 lg:ml-0"><button aria-label=search class="text-black hover:text-primary inline-block px-3 text-xl dark:text-white" id=search_toggle><svg height="16" width="16" viewBox="0 0 512 512" fill="currentcolor"><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8.0 45.3s-32.8 12.5-45.3.0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9.0 208S93.1.0 208 0 416 93.1 416 208zM208 352a144 144 0 100-288 144 144 0 100 288z"/></svg></button><div class="px-3 text-black hover:text-primary-700 dark:text-white dark:hover:text-primary-300
[&.active]:font-bold [&.active]:text-black/90 dark:[&.active]:text-white"><button class="theme-toggle mt-1" accesskey=t title=appearance><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="dark:hidden"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="dark:block [&:not(dark)]:hidden"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div><a href=/ class="inline-block rounded border px-5 py-2 font-semibold transition
md:ml-4 px-4 py-1.5 text-sm
border-black hover:bg-black dark:hover:bg-white dark:hover:text-black hover:text-white dark:border-white dark:text-white dark:hover:bg-white
hidden lg:inline-block">Get Started</a></div></nav></header><div id=search class="hidden p-3"></div></div><div class="page-body my-10"><div class="mx-auto flex max-w-screen-xl"><aside class="hb-sidebar-container max-lg:[transform:translate3d(0,-100%,0)] lg:hidden xl:block"><div class="px-4 pt-4 lg:hidden"></div><div class="hb-scrollbar lg:h-[calc(100vh-var(--navbar-height))]"><ul class="flex flex-col gap-1 lg:hidden"><li class=open><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/post/>Posts
<span data-hb-sidebar-toggle><svg fill="none" viewBox="0 0 24 24" stroke="currentcolor" class="h-[18px] min-w-[18px] rounded-sm p-0.5 hover:bg-gray-800/5 dark:hover:bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="origin-center transition-transform rtl:-rotate-180"/></svg></span></a><div class="ltr:pr-0 overflow-hidden"><ul class=hb-sidebar-list><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/post/eim/>index</a></li><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/post/nirb2grid/>index</a></li><li class="flex flex-col open"><a class="hb-sidebar-custom-link
sidebar-active-item bg-primary-100 font-semibold text-primary-800 dark:bg-primary-300 dark:text-primary-900" href=/post/pbdwadv/>index</a><ul class=hb-sidebar-mobile-toc><li><a href=# class=hb-docs-link></a></li><li><a href=#the-2d-advection-diffusion-model-problem class=hb-docs-link>The 2D advection-diffusion model problem:</a></li><li><a href=#the-pbdw-method-1 class=hb-docs-link>The PBDW method</a></li></ul></li><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/post/pbdwhelmholtz/>index</a></li><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/post/podgalerkin/>index</a></li><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/post/podi/>index</a></li><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/post/pbdw/>My Post</a></li></ul></div></li><li><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/blog/>Recent and Upcoming methods
<span data-hb-sidebar-toggle><svg fill="none" viewBox="0 0 24 24" stroke="currentcolor" class="h-[18px] min-w-[18px] rounded-sm p-0.5 hover:bg-gray-800/5 dark:hover:bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="origin-center transition-transform rtl:-rotate-180"/></svg></span></a><div class="ltr:pr-0 overflow-hidden"><ul class=hb-sidebar-list><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/blog/v1.0.0/>PBDW v1 released!</a></li><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/blog/todolist/>TODO list</a></li></ul></div></li><li><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/showcase/>More applications
<span data-hb-sidebar-toggle><svg fill="none" viewBox="0 0 24 24" stroke="currentcolor" class="h-[18px] min-w-[18px] rounded-sm p-0.5 hover:bg-gray-800/5 dark:hover:bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="origin-center transition-transform rtl:-rotate-180"/></svg></span></a><div class="ltr:pr-0 overflow-hidden"><ul class=hb-sidebar-list><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/showcase/cavity/>Cavity</a></li></ul></div></li><li><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/docs/>Documentation
<span data-hb-sidebar-toggle><svg fill="none" viewBox="0 0 24 24" stroke="currentcolor" class="h-[18px] min-w-[18px] rounded-sm p-0.5 hover:bg-gray-800/5 dark:hover:bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="origin-center transition-transform rtl:-rotate-180"/></svg></span></a><div class="ltr:pr-0 overflow-hidden"><ul class=hb-sidebar-list><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/docs/pod/>POD-Galerkin</a></li><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/docs/podi/>POD-Interpolation</a></li><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/docs/eim/>EIM</a></li><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/docs/nirb2grid/>NIRB 2-grid</a></li><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/docs/pbdw/>PBDW</a></li><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/docs/reference/>References</a></li></ul></div></li><li><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/events/>Events</a></li></ul><div class="max-xl:hidden h-0 w-64 shrink-0"></div></div></aside><nav class="hb-toc order-last hidden w-64 shrink-0 xl:block print:hidden px-4" aria-label="table of contents"><div class="hb-scrollbar text-sm [hyphens:auto] sticky top-16 overflow-y-auto pr-4 pt-6 max-h-[calc(100vh-var(--navbar-height)-env(safe-area-inset-bottom))] -mr-4 rtl:-ml-4"><p class="mb-4 font-semibold tracking-tight">On this page</p><ul><li class="my-2 scroll-my-6 scroll-py-6"><a class="pl-8 rtl:pr-8 inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#let-us-present-one-method-that-combines-model-order-reduction-and-a-data-assimilation-problem-the-parametrized-background-data-weak-method-pbdw>Let us present one method that combines model order reduction and a data assimilation problem: the Parametrized-Background Data-Weak method (PBDW).</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#the-2d-advection-diffusion-model-problem>The 2D advection-diffusion model problem:</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#the-pbdw-method-1>The PBDW method</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="pl-4 rtl:pr-4 inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#offline-part>OFFLINE PART</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="pl-8 rtl:pr-8 inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#pod-on-bk-model>POD on bk model</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="pl-8 rtl:pr-8 inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#construction-of-the-sensors>Construction of the sensors</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="pl-8 rtl:pr-8 inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#pbdw-algebraic-form>PBDW algebraic form</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="pl-8 rtl:pr-8 inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#online-part>ONLINE PART</a></li></ul><div class=backlinks><div class="mb-1 font-semibold tracking-tight">Backlinks</div><ul><li><a href=/docs/pbdw/ class=backlink>PBDW</a></li></ul></div></div></nav><article class="w-full break-words flex min-h-[calc(100vh-var(--navbar-height))] min-w-0 justify-center pb-8 pr-[calc(env(safe-area-inset-right)-1.5rem)]"><main class="w-full min-w-0 max-w-6xl px-6 pt-4 md:px-12"><h1 class="mt-2 text-4xl font-bold tracking-tight text-slate-900 dark:text-slate-100"></h1><div class="mt-4 mb-16"><div class="text-gray-500 dark:text-gray-300 text-sm flex items-center flex-wrap gap-y-2"><span class=mr-1>Dec 13, 2024</span>
<span class=mx-1>·</span>
<span class=mx-1>12 min read</span></div><div class=mt-3></div></div><div class="prose prose-slate lg:prose-xl dark:prose-invert"><h1 id=the-pbdw-method>THE PBDW method</h1><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span>
</span></span><span class=line><span class=cl><span class=err>!</span><span class=p>{</span><span class=n>sys</span><span class=o>.</span><span class=n>executable</span><span class=p>}</span> <span class=o>-</span><span class=n>m</span> <span class=n>pip</span> <span class=n>install</span> <span class=n>numpy</span>
</span></span><span class=line><span class=cl><span class=err>!</span><span class=p>{</span><span class=n>sys</span><span class=o>.</span><span class=n>executable</span><span class=p>}</span> <span class=o>-</span><span class=n>m</span> <span class=n>pip</span> <span class=n>install</span> <span class=n>matplotlib</span>
</span></span><span class=line><span class=cl><span class=err>!</span><span class=p>{</span><span class=n>sys</span><span class=o>.</span><span class=n>executable</span><span class=p>}</span> <span class=o>-</span><span class=n>m</span> <span class=n>pip</span> <span class=n>install</span> <span class=n>scikit</span><span class=o>-</span><span class=n>fem</span>
</span></span></code></pre></div><h4 id=let-us-present-one-method-that-combines-model-order-reduction-and-a-data-assimilation-problem-the-parametrized-background-data-weak-method-pbdw>Let us present one method that combines model order reduction and a data assimilation problem: the Parametrized-Background Data-Weak method (PBDW).</h4>$$ G^{bk,\mu}(u^{bk}(\mu)) = 0.$$$$ \mathcal{M}^{bk} = \{u^{bk}(\mu) : \mu \in \mathcal{P}^{bk}\}.$$<p>The PBDW formulation integrates the parameterized mathematical model $G^{pb}$ and $M$ experimental observations associated with a parameter configuration $\mu^{true}$ to estimate the true field $u^{true}(\mu^{true})$ as well as any desired output $l_{out}(u^{true}(\mu^{true}\
)) \in \mathbb{R}$ for given output functional $l_{out}$.<br>We intend that $\lVert u^{true}(\mu^{true})-u^{bk}(\mu^{true}) \rVert$ is small (i.e. that our model represents our data observations well).</p><p>The PBDW is decomposed in two parts: one offline and one online.</p><p>In the following notebook, we will employ:</p><ul><li>as our model problem a 2D advection-diffusion problem,</li><li>some measures that could also be possibly be noisy (here we will consider the case with no noise),</li><li>a sequence of background spaces that reflect our (prior) best knowledge model bk,</li><li>gaussians for our observations with a proper choice of localization.</li></ul><p>We will create measures artificially from our model problem by modifying the right hand side of our equation and the boundary conditions.</p>$$\mathcal{Z}_1 \subset \dots \subset \mathcal{Z}_{N} \subset \mathcal{U}. $$<p><br>To sum up, we consider two main ingredients:</p><ul><li>a model with a bias leading to the $(\mathcal{Z}_n)_n$ sequence,</li><li>and true measures, that might be noisy.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># import packages</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>skfem</span>  <span class=c1># for Finite Element Method</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span></code></pre></div><h2 id=the-2d-advection-diffusion-model-problem>The 2D advection-diffusion model problem:</h2><p>We are going to use in this example a 2D advection-diffusion problem with the Finite Element Method (FEM), which consists in
solving on a unit square (denoted $\Omega$) the following equations:</p>$$\begin{align*}
&- \Delta u + b(\mu) \cdot \nabla u =x_1 x_2 + g_1, \textrm{ in } \Omega,\\
& u=4 x_2(1-x_2)(1+g_2), \textrm{ on } \Omega_{left}:=\partial \Omega \cap \{x=0\},\\
& \partial_n u (\mu)=0, \textrm{ on } \partial \Omega \backslash \Omega_{left},
\end{align*}$$<p>where $u \in H^1(\Omega)$ represents the unknown, $\mu \in \mathbb{R}^2$ is our variable parameter, and $g_1$ and $g_2$ are two functions that allow us to construct a model with a bias with respect to the data observations. The lack of knowledge of the value of $\mu$ constitutes the anticipated parametric ignorance in the model, while uncertainty in $g_1$ and $g_2$ constitutes the unanticipated non-parametric ignorance.</p><p>We employ $P1$ finite elements to get a proper solution and obtain the system $\mathbf{A} \mathbf{x} =\mathbf{f}$ to solve where the assembled matrix $\mathbf{A}$ corresponds to the bilinear part $\int_{\Omega} (\nabla u, \nabla v) - (b(\mu),\nabla v) u + \int_{\Omega_{left}} (b(\mu), \nabla_n u) v $.</p><p>The dirichlet boundary conditions are imposed with a penalization method, called by the line:
solve(*condense(K,f, x=uvp, D=D)),</p><p>where x=uvp gives the values at the boundaries of the velocity and D refers to the boundary decomposition.</p><p>This problem model comes from the paper &ldquo;PBDW method for state estimation: error analysis for noisy data and non-linear formulation&rdquo;(<a href=https://arxiv.org/abs/1906.00810%29 target=_blank rel=noopener>https://arxiv.org/abs/1906.00810)</a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># First we define a mesh for the unit square</span>
</span></span><span class=line><span class=cl><span class=n>mesh</span><span class=o>=</span> <span class=n>skfem</span><span class=o>.</span><span class=n>MeshTri</span><span class=p>()</span><span class=o>.</span><span class=n>refined</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span><span class=o>.</span><span class=n>with_boundaries</span><span class=p>(</span>                                                                
</span></span><span class=line><span class=cl>        <span class=p>{</span>                                                                                                                                
</span></span><span class=line><span class=cl>            <span class=s2>&#34;left&#34;</span><span class=p>:</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>,</span>                                                                                            
</span></span><span class=line><span class=cl>            <span class=s2>&#34;right&#34;</span><span class=p>:</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span><span class=p>,</span>            
</span></span><span class=line><span class=cl>            <span class=s2>&#34;down&#34;</span><span class=p>:</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>,</span>                                                                                            
</span></span><span class=line><span class=cl>            <span class=s2>&#34;up&#34;</span><span class=p>:</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span><span class=p>,</span>     
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=p>}</span>                                                                                                                               
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>mesh</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>mesh</span>
</span></span></code></pre></div><pre><code>&lt;skfem MeshTri1 object&gt;
  Number of elements: 2048
  Number of vertices: 1089
  Number of nodes: 1089
  Named boundaries [# facets]: left [32], bottom [32], right [32], top [32], down [32], up [32]
</code></pre><p><figure><div class="flex justify-center"><div class=w-100><img src=./pbdw_5_1.svg alt=svg loading=lazy data-zoomable></div></div></figure></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;First step.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Assembling matrices</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>skfem.assembly</span> <span class=kn>import</span> <span class=n>BilinearForm</span><span class=p>,</span> <span class=n>LinearForm</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>skfem.helpers</span> <span class=kn>import</span> <span class=n>grad</span><span class=p>,</span> <span class=n>dot</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Bilinear form </span>
</span></span><span class=line><span class=cl><span class=nd>@BilinearForm</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>laplace</span><span class=p>(</span><span class=n>u</span><span class=p>,</span> <span class=n>v</span><span class=p>,</span> <span class=n>_</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>dot</span><span class=p>(</span><span class=n>grad</span><span class=p>(</span><span class=n>u</span><span class=p>),</span> <span class=n>grad</span><span class=p>(</span><span class=n>v</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@BilinearForm</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>gradu</span><span class=p>(</span><span class=n>u</span><span class=p>,</span> <span class=n>v</span><span class=p>,</span> <span class=n>w</span><span class=p>):</span>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=o>-</span> <span class=n>u</span><span class=o>*</span><span class=p>(</span><span class=n>v</span><span class=o>.</span><span class=n>grad</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>*</span><span class=n>w</span><span class=o>.</span><span class=n>bmu1</span><span class=o>+</span><span class=n>v</span><span class=o>.</span><span class=n>grad</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>*</span><span class=n>w</span><span class=o>.</span><span class=n>bmu2</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@BilinearForm</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>boundary_normal_gradient</span><span class=p>(</span><span class=n>u</span><span class=p>,</span> <span class=n>v</span><span class=p>,</span> <span class=n>w</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34; Bilinear part for int(grad_n(u), v) on the left boundary &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>dot</span><span class=p>(</span><span class=n>grad</span><span class=p>(</span><span class=n>u</span><span class=p>),</span> <span class=n>w</span><span class=o>.</span><span class=n>n</span><span class=p>)</span> <span class=o>*</span> <span class=n>v</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@BilinearForm</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>mass</span><span class=p>(</span><span class=n>u</span><span class=p>,</span> <span class=n>v</span><span class=p>,</span> <span class=n>_</span><span class=p>):</span> <span class=c1>#H1 norm (norm for the space U)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>u</span> <span class=o>*</span> <span class=n>v</span> <span class=o>+</span><span class=n>dot</span><span class=p>(</span><span class=n>grad</span><span class=p>(</span><span class=n>u</span><span class=p>),</span> <span class=n>grad</span><span class=p>(</span><span class=n>v</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@BilinearForm</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>L2mass</span><span class=p>(</span><span class=n>u</span><span class=p>,</span> <span class=n>v</span><span class=p>,</span> <span class=n>_</span><span class=p>):</span> <span class=c1>#L2 norm</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>u</span> <span class=o>*</span> <span class=n>v</span> 
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>  
</span></span></code></pre></div><p>In the code bellow, the function SolveAdvDiffProblem([mu1,mu2],Mesh,measures) takes as inputs the parameter $\mu \in \mathcal{P}^{bk} \subset \mathbb{R}^2$, a mesh, and a boolean used for the bias on the right-hand side function and on the dirichlet boundary conditions, and it returns the associated solution.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>skfem</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=c1># Compute solution </span>
</span></span><span class=line><span class=cl><span class=n>element</span> <span class=o>=</span> <span class=n>ElementTriP1</span><span class=p>()</span> <span class=c1>#P1 FEM elements</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>SolveAdvDiffProblem</span><span class=p>(</span><span class=n>mu</span><span class=p>,</span><span class=n>Mesh</span><span class=p>,</span><span class=n>measures</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># mu: variable parameter</span>
</span></span><span class=line><span class=cl>    <span class=c1># mesh: FE mesh</span>
</span></span><span class=line><span class=cl>    <span class=c1># measures: Boolean (if true, the right-hand side function and dirichlet parameter are adapted to the generation of the data observations)</span>
</span></span><span class=line><span class=cl>    <span class=n>basis</span> <span class=o>=</span> <span class=n>Basis</span><span class=p>(</span><span class=n>Mesh</span><span class=p>,</span> <span class=n>element</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>    <span class=c1>#print(&#39;Parameter mu:&#39;,mu)</span>
</span></span><span class=line><span class=cl>    <span class=n>mu1</span><span class=p>,</span><span class=n>mu2</span><span class=o>=</span><span class=n>mu</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=n>mu</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>bmu1</span><span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>mu</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>*</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>mu</span><span class=p>[</span><span class=mi>1</span><span class=p>]))</span> 
</span></span><span class=line><span class=cl>    <span class=n>bmu2</span><span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>mu</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>*</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>mu</span><span class=p>[</span><span class=mi>1</span><span class=p>]))</span> 
</span></span><span class=line><span class=cl>    <span class=n>bmu1</span><span class=o>=</span><span class=n>basis</span><span class=o>.</span><span class=n>project</span><span class=p>(</span><span class=n>bmu1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>bmu2</span><span class=o>=</span><span class=n>basis</span><span class=o>.</span><span class=n>project</span><span class=p>(</span><span class=n>bmu2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>## Assembling global problem</span>
</span></span><span class=line><span class=cl>    <span class=n>A</span><span class=o>=</span> <span class=n>laplace</span><span class=o>.</span><span class=n>assemble</span><span class=p>(</span><span class=n>basis</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>A2</span><span class=o>=</span><span class=n>gradu</span><span class=o>.</span><span class=n>assemble</span><span class=p>(</span><span class=n>basis</span><span class=p>,</span><span class=n>bmu1</span><span class=o>=</span><span class=n>basis</span><span class=o>.</span><span class=n>interpolate</span><span class=p>(</span><span class=n>bmu1</span><span class=p>),</span><span class=n>bmu2</span><span class=o>=</span><span class=n>basis</span><span class=o>.</span><span class=n>interpolate</span><span class=p>(</span><span class=n>bmu2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>A</span><span class=o>+=</span><span class=n>A2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>## boundary conditions</span>
</span></span><span class=line><span class=cl>    <span class=n>left_basis</span> <span class=o>=</span> <span class=n>FacetBasis</span><span class=p>(</span><span class=n>Mesh</span><span class=p>,</span> <span class=n>element</span><span class=p>,</span> <span class=n>facets</span><span class=o>=</span><span class=n>Mesh</span><span class=o>.</span><span class=n>boundaries</span><span class=p>[</span><span class=s1>&#39;right&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>profil_left</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># Dirichlet boundary conditions</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>measures</span><span class=o>==</span><span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1>#return (x[0]==1)*200*x[1]#(8*x[1]*(1-x[1])*(1+ np.sin(2*np.pi*x[1]))) #with g2!=0</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>(</span><span class=n>x</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>==</span><span class=mi>1</span><span class=p>)</span><span class=o>*</span><span class=p>(</span><span class=mi>4</span><span class=o>*</span><span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>*</span><span class=p>(</span><span class=mi>1</span><span class=o>-</span><span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span><span class=o>*</span><span class=p>(</span><span class=mi>1</span><span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=mi>2</span><span class=o>*</span><span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>*</span><span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>])))</span> <span class=c1>#with g2!=0</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1>#return (x[0]==1)*100*x[1]#(4*x[1]*(1-x[1]))  #with g2=0</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>(</span><span class=n>x</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>==</span><span class=mi>1</span><span class=p>)</span><span class=o>*</span><span class=p>(</span><span class=mi>4</span><span class=o>*</span><span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>*</span><span class=p>(</span><span class=mi>1</span><span class=o>-</span><span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>]))</span>  <span class=c1>#with g2=0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>u_boundary</span><span class=o>=</span><span class=n>left_basis</span><span class=o>.</span><span class=n>project</span><span class=p>(</span><span class=n>profil_left</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>D</span> <span class=o>=</span> <span class=n>basis</span><span class=o>.</span><span class=n>get_dofs</span><span class=p>([</span><span class=s1>&#39;right&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=c1>## Neumann boundary conditions </span>
</span></span><span class=line><span class=cl>    <span class=n>A_boundary</span> <span class=o>=</span> <span class=n>boundary_normal_gradient</span><span class=o>.</span><span class=n>assemble</span><span class=p>(</span><span class=n>left_basis</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>A</span><span class=o>+=</span><span class=n>A_boundary</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>## Right hand side functions</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>measures</span><span class=o>==</span><span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1>#g1 = lambda x: x[0]**2 -x[1] #with g1!=0</span>
</span></span><span class=line><span class=cl>        <span class=n>g1</span> <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=mf>0.2</span><span class=o>*</span><span class=n>x</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>**</span><span class=mi>2</span> <span class=o>+</span><span class=n>x</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>*</span><span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=c1>#with g1!=0</span>
</span></span><span class=line><span class=cl>        <span class=n>g_proj1</span> <span class=o>=</span> <span class=n>basis</span><span class=o>.</span><span class=n>project</span><span class=p>(</span><span class=n>g1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1>#g1 = lambda x: -x[1] #with g1=0</span>
</span></span><span class=line><span class=cl>        <span class=n>g1</span> <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>*</span><span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=c1>#with g1!=0</span>
</span></span><span class=line><span class=cl>        <span class=n>g_proj1</span> <span class=o>=</span> <span class=n>basis</span><span class=o>.</span><span class=n>project</span><span class=p>(</span><span class=n>g1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=n>f</span><span class=o>=</span><span class=n>g_proj1</span>
</span></span><span class=line><span class=cl>    <span class=n>u</span> <span class=o>=</span> <span class=n>solve</span><span class=p>(</span><span class=o>*</span><span class=n>condense</span><span class=p>(</span><span class=n>A</span><span class=p>,</span><span class=n>f</span><span class=p>,</span> <span class=n>x</span><span class=o>=</span><span class=n>u_boundary</span><span class=p>,</span> <span class=n>D</span><span class=o>=</span><span class=n>D</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>u</span>
</span></span><span class=line><span class=cl>    
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>## plot the solution</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>skfem.visuals.matplotlib</span> <span class=kn>import</span> <span class=n>plot</span><span class=p>,</span> <span class=n>draw</span><span class=p>,</span> <span class=n>savefig</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>u</span><span class=o>=</span><span class=n>SolveAdvDiffProblem</span><span class=p>([</span><span class=mf>0.4</span><span class=p>,</span><span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>6</span><span class=p>],</span><span class=n>mesh</span><span class=p>,</span><span class=kc>True</span><span class=p>)</span> <span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=n>plot</span><span class=p>(</span><span class=n>mesh</span><span class=p>,</span> <span class=n>u</span><span class=p>,</span> <span class=n>shading</span><span class=o>=</span><span class=s1>&#39;gouraud&#39;</span><span class=p>,</span> <span class=n>colorbar</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>u</span><span class=o>=</span><span class=n>SolveAdvDiffProblem</span><span class=p>([</span><span class=mf>0.4</span><span class=p>,</span><span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>6</span><span class=p>],</span><span class=n>mesh</span><span class=p>,</span><span class=kc>False</span><span class=p>)</span> <span class=c1># examples</span>
</span></span><span class=line><span class=cl><span class=n>plot</span><span class=p>(</span><span class=n>mesh</span><span class=p>,</span> <span class=n>u</span><span class=p>,</span> <span class=n>shading</span><span class=o>=</span><span class=s1>&#39;gouraud&#39;</span><span class=p>,</span> <span class=n>colorbar</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span></code></pre></div><pre><code>&lt;Axes: &gt;
</code></pre><p><figure><div class="flex justify-center"><div class=w-100><img src=./pbdw_9_1.png alt=png loading=lazy data-zoomable></div></div></figure></p><p><figure><div class="flex justify-center"><div class=w-100><img src=./pbdw_9_2.png alt=png loading=lazy data-zoomable></div></div></figure></p><h2 id=the-pbdw-method-1>The PBDW method</h2><p>We are now able to proceed with the offline and online parts of the PBDW method.
We start with a classical POD algorithm on the bk model with bias, but first we construct the data observations $u^{true}(\mu^{true})$ artificially (here we consider that we have access to the data in the whole domain).</p><h3 id=offline-part>OFFLINE PART</h3><p>We define one fine mesh called &ldquo;FineMesh&rdquo; in the code</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>## FINE MESH</span>
</span></span><span class=line><span class=cl><span class=n>FineMesh</span> <span class=o>=</span> <span class=n>skfem</span><span class=o>.</span><span class=n>MeshTri</span><span class=p>()</span><span class=o>.</span><span class=n>refined</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span><span class=o>.</span><span class=n>with_boundaries</span><span class=p>(</span>                                                                
</span></span><span class=line><span class=cl>        <span class=p>{</span>                                                                                                                                
</span></span><span class=line><span class=cl>            <span class=s2>&#34;left&#34;</span><span class=p>:</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>,</span>                                                                                            
</span></span><span class=line><span class=cl>            <span class=s2>&#34;right&#34;</span><span class=p>:</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span><span class=p>,</span>            
</span></span><span class=line><span class=cl>            <span class=s2>&#34;down&#34;</span><span class=p>:</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>,</span>                                                                                            
</span></span><span class=line><span class=cl>            <span class=s2>&#34;up&#34;</span><span class=p>:</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span><span class=p>,</span>     
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=p>}</span>                                                                                                                               
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>FineBasis</span> <span class=o>=</span> <span class=n>Basis</span><span class=p>(</span><span class=n>FineMesh</span><span class=p>,</span> <span class=n>element</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>NumberOfNodesFineMesh</span> <span class=o>=</span> <span class=n>FineMesh</span><span class=o>.</span><span class=n>p</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;number of nodes: &#34;</span><span class=p>,</span><span class=n>NumberOfNodesFineMesh</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>num_dofs_uFineMesh</span> <span class=o>=</span> <span class=n>FineBasis</span><span class=o>.</span><span class=n>doflocs</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=c1># or np.shape(u)[0] for DOFs</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;number of DoFs: &#34;</span><span class=p>,</span><span class=n>num_dofs_uFineMesh</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>massMat</span><span class=o>=</span><span class=n>mass</span><span class=o>.</span><span class=n>assemble</span><span class=p>(</span><span class=n>FineBasis</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>L2massMat</span><span class=o>=</span><span class=n>L2mass</span><span class=o>.</span><span class=n>assemble</span><span class=p>(</span><span class=n>FineBasis</span><span class=p>)</span>
</span></span></code></pre></div><pre><code>number of nodes:  1089
number of DoFs:  1089
</code></pre><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>utrue</span><span class=o>=</span><span class=n>SolveAdvDiffProblem</span><span class=p>([</span><span class=mf>1.4</span><span class=p>,</span><span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>3</span><span class=p>],</span><span class=n>mesh</span><span class=p>,</span><span class=kc>True</span><span class=p>)</span> <span class=c1># True for measures</span>
</span></span><span class=line><span class=cl><span class=n>plot</span><span class=p>(</span><span class=n>FineMesh</span><span class=p>,</span> <span class=n>utrue</span><span class=p>,</span> <span class=n>shading</span><span class=o>=</span><span class=s1>&#39;gouraud&#39;</span><span class=p>,</span> <span class=n>colorbar</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span></code></pre></div><pre><code>&lt;Axes: &gt;
</code></pre><p><figure><div class="flex justify-center"><div class=w-100><img src=./pbdw_14_1.png alt=png loading=lazy data-zoomable></div></div></figure></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python></code></pre></div><h4 id=pod-on-bk-model>POD on bk model</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34; POD on the bk model (could be done with a greedy approach) &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;-----------------------------------&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;        Offline POD                &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;-----------------------------------&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>NumberOfSnapshots</span><span class=o>=</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>NumberOfModesN</span><span class=o>=</span><span class=mi>15</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;number of modes for the bk model: &#34;</span><span class=p>,</span><span class=n>NumberOfModesN</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>mu1list</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mf>0.1</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>mu2list</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>2</span><span class=p>,</span><span class=mi>10</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>FineSnapshots</span><span class=o>=</span><span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>mu1</span> <span class=ow>in</span> <span class=p>(</span><span class=n>mu1list</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>mu2</span> <span class=ow>in</span> <span class=p>(</span><span class=n>mu2list</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>u</span><span class=o>=</span><span class=n>SolveAdvDiffProblem</span><span class=p>([</span><span class=n>mu1</span><span class=p>,</span><span class=n>mu2</span><span class=p>],</span><span class=n>FineMesh</span><span class=p>,</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>FineSnapshots</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>u</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>NumberOfSnapshots</span><span class=o>+=</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## SVD ##</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=c1># We first compute the correlation matrix C_ij = (u_i,u_j)_U</span>
</span></span><span class=line><span class=cl><span class=n>CorrelationMatrix</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=n>NumberOfSnapshots</span><span class=p>,</span> <span class=n>NumberOfSnapshots</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>snapshot1</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>FineSnapshots</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>MatVecProduct</span> <span class=o>=</span> <span class=n>massMat</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>snapshot1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span><span class=p>,</span> <span class=n>snapshot2</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>FineSnapshots</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>i</span> <span class=o>&gt;=</span> <span class=n>j</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>CorrelationMatrix</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>MatVecProduct</span><span class=p>,</span> <span class=n>snapshot2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>CorrelationMatrix</span><span class=p>[</span><span class=n>j</span><span class=p>,</span> <span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>CorrelationMatrix</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Then, we compute the eigenvalues/eigenvectors of C </span>
</span></span><span class=line><span class=cl><span class=n>EigenValues</span><span class=p>,</span> <span class=n>EigenVectors</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>eigh</span><span class=p>(</span><span class=n>CorrelationMatrix</span><span class=p>,</span> <span class=n>UPLO</span><span class=o>=</span><span class=s2>&#34;L&#34;</span><span class=p>)</span> <span class=c1>#SVD: C eigenVectors=eigenValues eigenVectors</span>
</span></span><span class=line><span class=cl><span class=n>idx</span> <span class=o>=</span> <span class=n>EigenValues</span><span class=o>.</span><span class=n>argsort</span><span class=p>()[::</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=c1># sort the eigenvalues</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>TotEigenValues</span> <span class=o>=</span> <span class=n>EigenValues</span><span class=p>[</span><span class=n>idx</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>TotEigenVectors</span> <span class=o>=</span> <span class=n>EigenVectors</span><span class=p>[:,</span> <span class=n>idx</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>EigenValues</span><span class=o>=</span><span class=n>TotEigenValues</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=n>NumberOfModesN</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>EigenVectors</span><span class=o>=</span><span class=n>TotEigenVectors</span><span class=p>[:,</span><span class=mi>0</span><span class=p>:</span><span class=n>NumberOfModesN</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;eigenvalues: &#34;</span><span class=p>,</span><span class=n>EigenValues</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>RIC</span><span class=o>=</span><span class=mi>1</span><span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>EigenValues</span><span class=p>)</span><span class=o>/</span><span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>TotEigenValues</span><span class=p>)</span> <span class=c1>#must be close to 0</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Relativ Information Content:&#34;</span><span class=p>,</span><span class=n>RIC</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ChangeOfBasisMatrix</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=n>NumberOfModesN</span><span class=p>,</span><span class=n>NumberOfSnapshots</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>NumberOfModesN</span><span class=p>):</span><span class=c1>#orthonormalization</span>
</span></span><span class=line><span class=cl>    <span class=n>ChangeOfBasisMatrix</span><span class=p>[</span><span class=n>j</span><span class=p>,:]</span> <span class=o>=</span> <span class=n>EigenVectors</span><span class=p>[:,</span><span class=n>j</span><span class=p>]</span><span class=o>/</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>EigenValues</span><span class=p>[</span><span class=n>j</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>bkReducedBasis</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>ChangeOfBasisMatrix</span><span class=p>,</span><span class=n>FineSnapshots</span><span class=p>)</span>
</span></span></code></pre></div><pre><code>-----------------------------------
        Offline POD                
-----------------------------------
number of modes for the bk model:  15
eigenvalues:  [2.03866121e+06 1.98788941e+05 7.63460590e+04 3.57206711e+03
 3.26553742e+03 1.08125000e+03 4.08015648e+01 3.47784483e+01
 2.37761217e+01 4.40644071e+00 3.45055983e-01 1.56321411e-01
 1.29748847e-01 6.77589026e-02 9.30473722e-03]
Relativ Information Content: 1.3066825399477011e-09
</code></pre><p>Now we can check for the reduced basis accuracy.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;-----------------------------------&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;             Reduced basis accuracy&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;-----------------------------------&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>### Offline Errors</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Offline Errors&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>CompressionErrors</span><span class=o>=</span><span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>H1compressionErrors</span><span class=o>=</span><span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#for snap in FineSnapshots:</span>
</span></span><span class=line><span class=cl><span class=c1>#    ExactSolution =snap</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>mu1</span> <span class=ow>in</span> <span class=p>(</span><span class=n>mu1list</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>mu2</span> <span class=ow>in</span> <span class=p>(</span><span class=n>mu2list</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>ExactSolution</span><span class=o>=</span><span class=n>SolveAdvDiffProblem</span><span class=p>([</span><span class=n>mu1</span><span class=p>,</span><span class=n>mu2</span><span class=p>],</span><span class=n>FineMesh</span><span class=p>,</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1>#ExactSolutionbis=SolveAdvDiffProblem([mu1,mu2],FineMesh,False)</span>
</span></span><span class=line><span class=cl>        <span class=n>CompressedSolutionU</span><span class=o>=</span> <span class=n>ExactSolution</span><span class=o>@</span><span class=p>(</span><span class=n>massMat</span><span class=nd>@bkReducedBasis.transpose</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=n>ReconstructedCompressedSolution</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>CompressedSolutionU</span><span class=p>,</span> <span class=n>bkReducedBasis</span><span class=p>)</span> <span class=c1>#pas de tps 0</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>        <span class=n>norml2ExactSolution</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>ExactSolution</span><span class=o>@</span><span class=p>(</span><span class=n>L2massMat</span><span class=nd>@ExactSolution</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>normh1ExactSolution</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>ExactSolution</span><span class=o>@</span><span class=p>(</span><span class=n>massMat</span><span class=nd>@ExactSolution</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>t</span><span class=o>=</span><span class=n>ReconstructedCompressedSolution</span><span class=o>-</span><span class=n>ExactSolution</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>norml2ExactSolution</span> <span class=o>!=</span><span class=mi>0</span> <span class=ow>and</span> <span class=n>normh1ExactSolution</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>relError</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>t</span><span class=nd>@L2massMat@t</span><span class=p>)</span><span class=o>/</span><span class=n>norml2ExactSolution</span>
</span></span><span class=line><span class=cl>            <span class=n>relh1Error</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>t</span><span class=nd>@massMat@t</span><span class=p>)</span><span class=o>/</span><span class=n>normh1ExactSolution</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>relError</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>norm</span><span class=p>(</span><span class=n>ReconstructedCompressedSolution</span><span class=o>-</span><span class=n>ExactSolution</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>CompressionErrors</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>relError</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>H1compressionErrors</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>relh1Error</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>mu1</span><span class=o>==</span><span class=mf>2.275</span> <span class=ow>and</span> <span class=n>mu2</span><span class=o>==</span><span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>plot</span><span class=p>(</span><span class=n>FineMesh</span><span class=p>,</span> <span class=n>ExactSolution</span><span class=p>,</span> <span class=n>shading</span><span class=o>=</span><span class=s1>&#39;gouraud&#39;</span><span class=p>,</span> <span class=n>colorbar</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>plot</span><span class=p>(</span><span class=n>FineMesh</span><span class=p>,</span> <span class=n>ExactSolutionbis</span><span class=p>,</span> <span class=n>shading</span><span class=o>=</span><span class=s1>&#39;gouraud&#39;</span><span class=p>,</span> <span class=n>colorbar</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>plot</span><span class=p>(</span><span class=n>FineMesh</span><span class=p>,</span> <span class=n>ReconstructedCompressedSolution</span><span class=p>,</span> <span class=n>shading</span><span class=o>=</span><span class=s1>&#39;gouraud&#39;</span><span class=p>,</span> <span class=n>colorbar</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;L2 compression error =&#34;</span><span class=p>,</span> <span class=n>CompressionErrors</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;H1 compression error =&#34;</span><span class=p>,</span> <span class=n>H1compressionErrors</span><span class=p>)</span>
</span></span></code></pre></div><pre><code>-----------------------------------
             Reduced basis accuracy
-----------------------------------
Offline Errors
L2 compression error = [4.464044518872249e-06, 3.2948510494119077e-06, 2.290250760263449e-06, 1.4675605306478524e-06, 8.915840966017943e-07, 7.557337160345698e-07, 1.0344107189534399e-06, 1.4292838150362181e-06, 1.839008459568471e-06, 2.260403555595182e-06, 5.6419137062022195e-06, 3.0292521469093515e-06, 2.638316514323157e-06, 2.9735064128926414e-06, 3.1133058130523887e-06, 3.071241432378604e-06, 3.0903399820237977e-06, 3.4597258065352133e-06, 4.385570343265425e-06, 5.914766889195202e-06, 6.466039662035052e-06, 2.2828281714074417e-06, 3.719265675449631e-06, 4.07665068527531e-06, 3.733074907693582e-06, 3.3228223211801526e-06, 3.0466976159325082e-06, 2.8139328856957787e-06, 2.7628176702476534e-06, 4.417740843515894e-06, 6.878018194786359e-06, 4.343622954486847e-06, 5.6479455139503074e-06, 4.983955485533267e-06, 4.643064369149396e-06, 4.356187524270617e-06, 4.068903388344752e-06, 4.325844963914229e-06, 4.463838149770944e-06, 5.069891550394366e-06, 7.252968845644662e-06, 7.1161760893413015e-06, 5.825223666363488e-06, 4.9078655698982395e-06, 6.477105587901556e-06, 5.629623181915566e-06, 3.435985246077469e-06, 3.666591301006391e-06, 4.3126374326462805e-06, 4.930810679681774e-06, 7.765028936646113e-06, 1.0758022999484722e-05, 5.765204954875644e-06, 6.881897092663532e-06, 9.823215026672102e-06, 7.545388982775257e-06, 4.999511761920188e-06, 6.2501806939502245e-06, 5.956618838091266e-06, 5.393592227066799e-06, 8.420860575531317e-06, 1.530055486222261e-05, 6.4263504016545675e-06, 8.70585220712872e-06, 1.093564578021148e-05, 5.531485466266688e-06, 4.88248204190274e-06, 7.536660217951777e-06, 5.605723600322189e-06, 6.0522794976476525e-06, 1.0317064718671453e-05, 2.021801920620293e-05, 7.932386218640109e-06, 1.0181978031918473e-05, 1.1198354134825336e-05, 5.04031183625094e-06, 8.884774594090558e-06, 8.337725622089321e-06, 3.784191171541323e-06, 7.740234225023708e-06, 1.7396051662626773e-05, 2.490089983737211e-05, 1.0177261735907454e-05, 1.2420205045018331e-05, 1.2400700091772858e-05, 9.107295330219943e-06, 1.322879798530576e-05, 8.462896334417241e-06, 8.136017146956131e-06, 7.40573172752598e-06, 3.319480686662823e-05, 2.8865070992548302e-05, 1.2764357020348877e-05, 1.617969257609354e-05, 1.3977194466545846e-05, 1.1508196930328714e-05, 1.4325893468926336e-05, 9.600712833369026e-06, 1.5911312993681602e-05, 1.1185720850111092e-05]
H1 compression error = [2.7252932301889785e-05, 2.013750683906652e-05, 1.402739794153043e-05, 9.03203033440891e-06, 5.587308491638867e-06, 4.914693737670023e-06, 6.770478212303681e-06, 9.377848140674137e-06, 1.2148886270479421e-05, 1.5068140469183008e-05, 3.538305427019371e-05, 1.9688743754521856e-05, 1.6012708785290326e-05, 1.733984297032835e-05, 1.82353361047264e-05, 1.8227299129936916e-05, 1.8412505197389516e-05, 2.0446903618376864e-05, 2.592173938409032e-05, 3.554656059492433e-05, 3.796273452215796e-05, 1.4436918887135222e-05, 2.092649864639411e-05, 2.3683363675915002e-05, 2.2848548422432317e-05, 2.1207231093055237e-05, 1.9563234268424123e-05, 1.7360600445174253e-05, 1.6053761582722742e-05, 2.7579187022371675e-05, 3.8786741840616874e-05, 2.2619722066470402e-05, 3.0113021819023792e-05, 2.82996368838738e-05, 2.656205066435831e-05, 2.4652490908009468e-05, 2.3350583231630944e-05, 2.454448822024161e-05, 2.4121676619653384e-05, 3.0152660068145523e-05, 4.10866622034923e-05, 3.35404485790202e-05, 3.063462381567499e-05, 2.689789093972627e-05, 3.151552824445099e-05, 2.6637387395390685e-05, 1.79925538977804e-05, 2.1420579255796295e-05, 2.294970681598286e-05, 2.71096597917859e-05, 4.436459028061381e-05, 4.8435418288719186e-05, 3.0530069439965646e-05, 3.176041176607239e-05, 4.273556464930769e-05, 3.2664926942419514e-05, 2.3358513419411886e-05, 3.154113689298677e-05, 2.9969324371075966e-05, 2.759118381889585e-05, 4.675240980636919e-05, 6.692728464979316e-05, 3.213983174315306e-05, 3.521510054042893e-05, 4.534984712394246e-05, 2.3582656573518707e-05, 2.1276223191861312e-05, 3.4513081768172264e-05, 2.7845065891343934e-05, 2.9574001635377192e-05, 5.137634592785078e-05, 8.61508367731696e-05, 3.6750504542604e-05, 4.031827349791773e-05, 4.714785992850797e-05, 2.1638631599125338e-05, 3.3666719164020035e-05, 3.3455551337854464e-05, 1.983379959723556e-05, 3.3242891489082104e-05, 7.50107840515417e-05, 0.0001031623106532193, 4.529839464211873e-05, 5.104232741789849e-05, 5.126545848318776e-05, 3.3064402356663036e-05, 4.785757709236215e-05, 3.1064457959244826e-05, 3.314365823126774e-05, 2.8298730472408282e-05, 0.00013533770789244366, 0.0001159802382139368, 5.6097565167957744e-05, 6.732256071877919e-05, 5.852998165365517e-05, 5.1157193654252605e-05, 5.843907884382997e-05, 3.895991570740153e-05, 6.118099709629903e-05, 4.0914896868423286e-05]
</code></pre><h4 id=construction-of-the-sensors>Construction of the sensors</h4><p>We now characterize our measures:</p>$$\forall m=1,\dots,M, y_m^{obs}=l^0_m(u^{true}(\mu^{true})).$$<p><br>Here $y_m^{obs}(\mu^{true})$ is the value of the $m$-th observation, with $l_m^0 \in \mathcal{U}'$. The form of the observation functional depends on the specific transducer used to acquire data. For instance, if the transducer measures a local state value, then we may model the observation as a Gaussian convolution (like in this example).</p>$$\forall m=1,\dots,M, \ q_m = R_u l^0_m,$$<p><br>which is the Riesz representation of the functional.
The condition $(q_m,v)=l_m^0(v)$ is equivalent to the resolution of the following problem:</p><p>Find $q_m \in \mathcal{U}$ such that:
$M q_m=b$ with $M $ the mass matrix and $b$ the vector obtained from the observation functionals $b_i=l_m^0(v_i)$ where $v_i$ are the FEM test functions.</p>$$\forall M=1,\dots,M_{max},\ \mathcal{U}_M=\textrm{Span} \{ q_m\}_{m=1}^M. $$<p>We want to choose the localization of the sensors adequately in order to get $M$ small such that $(q_m)_{m=1}^M \in (\mathcal{U}_M)^M$ forms a canonical reduced basis of the observation spaces.</p>$$l_m(v)=l_m(v,x_m,r_w)=C \int_{\Omega} exp \Big(-\frac{1}{2r_w^2}\lVert x-x_m \rVert_2^2 \Big) v(x) \ \textrm{dx},$$<p>where $C$ is such that $l_m(1)=1$, and $x_m$ corresponds to the center of the $m$-sensor localization.
In this example, we take these centers as the nodes of a coarser mesh but we could have used a GEIM to choose them more wisely.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>rw</span> <span class=o>=</span> <span class=mf>0.01</span>  <span class=c1># deviation r_w</span>
</span></span><span class=line><span class=cl><span class=n>xm</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mf>0.5</span><span class=p>,</span> <span class=mf>0.5</span><span class=p>])</span> <span class=c1>#for test</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## Normalization of the gaussian functionals</span>
</span></span><span class=line><span class=cl><span class=c1>## lm = C exp(-||x - x_m||^2 / (2 * r_w^2))</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>gaussian_weight_noC</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>xm</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34; Gaussian function centered on xm of deviation rw (to find C for normalization). &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=o>-</span><span class=mf>0.5</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>((</span><span class=n>x</span> <span class=o>-</span> <span class=n>xm</span><span class=p>[:,</span> <span class=n>np</span><span class=o>.</span><span class=n>newaxis</span><span class=p>,</span><span class=n>np</span><span class=o>.</span><span class=n>newaxis</span><span class=p>])</span><span class=o>**</span><span class=mi>2</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span> <span class=o>/</span> <span class=n>rw</span><span class=o>**</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>compute_C</span><span class=p>(</span><span class=n>xm</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># takes xm center of sensor as parameter</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@LinearForm</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>lm</span><span class=p>(</span><span class=n>v</span><span class=p>,</span> <span class=n>w</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34; Computes lm(1) by integrating the Gaussian weight. &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>        <span class=n>weight</span> <span class=o>=</span> <span class=n>gaussian_weight_noC</span><span class=p>(</span><span class=n>w</span><span class=o>.</span><span class=n>x</span><span class=p>,</span><span class=n>xm</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>weight</span> <span class=o>*</span> <span class=n>v</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Assemble the linear form for lm(1)</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span> <span class=o>=</span> <span class=n>lm</span><span class=o>.</span><span class=n>assemble</span><span class=p>(</span><span class=n>FineBasis</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>lm_value</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>  <span class=c1># Numerical integration result: b@1 since v=1</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>C</span> <span class=o>=</span> <span class=mf>1.0</span> <span class=o>/</span> <span class=n>lm_value</span>  <span class=c1># Scaling factor</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>C</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>C</span> <span class=o>=</span> <span class=n>compute_C</span><span class=p>(</span><span class=n>xm</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># lm = C exp(-||x - x_m||^2 / (2 * r_w^2))</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>gaussian_weight</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>xm</span><span class=p>,</span><span class=n>C</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34; Gaussian function centered on xm of deviation rw &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>C</span><span class=o>*</span><span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=o>-</span><span class=mf>0.5</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>((</span><span class=n>x</span> <span class=o>-</span> <span class=n>xm</span><span class=p>[:,</span> <span class=n>np</span><span class=o>.</span><span class=n>newaxis</span><span class=p>,</span><span class=n>np</span><span class=o>.</span><span class=n>newaxis</span><span class=p>])</span><span class=o>**</span><span class=mi>2</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span> <span class=o>/</span> <span class=n>rw</span><span class=o>**</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>qm_b</span><span class=p>(</span><span class=n>xm</span><span class=p>,</span><span class=n>C</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># weak formulation</span>
</span></span><span class=line><span class=cl>    <span class=c1># mass matrix : (v, q_m)_U</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@LinearForm</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>rhs</span><span class=p>(</span><span class=n>v</span><span class=p>,</span> <span class=n>w</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34; Right hand side  &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>weight</span> <span class=o>=</span> <span class=n>gaussian_weight</span><span class=p>(</span><span class=n>w</span><span class=o>.</span><span class=n>x</span><span class=p>,</span><span class=n>xm</span><span class=p>,</span><span class=n>C</span><span class=p>)</span>  <span class=c1># Applique la gaussienne</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>weight</span> <span class=o>*</span> <span class=n>v</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Assembling</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span> <span class=o>=</span> <span class=n>rhs</span><span class=o>.</span><span class=n>assemble</span><span class=p>(</span><span class=n>FineBasis</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Solving the linear system</span>
</span></span><span class=line><span class=cl>    <span class=kn>from</span> <span class=nn>scipy.sparse.linalg</span> <span class=kn>import</span> <span class=n>spsolve</span>
</span></span><span class=line><span class=cl>    <span class=c1>#from scipy.sparse.linalg import cg</span>
</span></span><span class=line><span class=cl>    <span class=c1>#q_m, info = cg(M, b)</span>
</span></span><span class=line><span class=cl>    <span class=c1>#if info == 0:</span>
</span></span><span class=line><span class=cl>    <span class=c1>#    print(&#34;Conjugate Gradient converged!&#34;)</span>
</span></span><span class=line><span class=cl>    <span class=c1>#else:</span>
</span></span><span class=line><span class=cl>    <span class=c1>#    print(&#34;Conjugate Gradient did not converge.&#34;)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>q_m</span> <span class=o>=</span> <span class=n>spsolve</span><span class=p>(</span><span class=n>massMat</span><span class=p>,</span> <span class=n>b</span><span class=p>)</span>  <span class=c1># Resolution of M @ q_m = b</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>q_m</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>## sensors localizations from a coarser mesh M=25</span>
</span></span><span class=line><span class=cl><span class=c1>## Coarse MESH</span>
</span></span><span class=line><span class=cl><span class=n>CoarseMesh</span> <span class=o>=</span> <span class=n>skfem</span><span class=o>.</span><span class=n>MeshTri</span><span class=p>()</span><span class=o>.</span><span class=n>refined</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span><span class=o>.</span><span class=n>with_boundaries</span><span class=p>(</span>                                                                
</span></span><span class=line><span class=cl>        <span class=p>{</span>                                                                                                                                
</span></span><span class=line><span class=cl>            <span class=s2>&#34;left&#34;</span><span class=p>:</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>,</span>                                                                                            
</span></span><span class=line><span class=cl>            <span class=s2>&#34;right&#34;</span><span class=p>:</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span><span class=p>,</span>            
</span></span><span class=line><span class=cl>            <span class=s2>&#34;down&#34;</span><span class=p>:</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>,</span>                                                                                            
</span></span><span class=line><span class=cl>            <span class=s2>&#34;up&#34;</span><span class=p>:</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span><span class=p>,</span>     
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=p>}</span>                                                                                                                               
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>xm_grid</span><span class=o>=</span><span class=n>CoarseMesh</span><span class=o>.</span><span class=n>p</span> <span class=c1>#xm = nodes</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>qmReducedBasis</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=n>num_dofs_uFineMesh</span><span class=p>,</span><span class=n>CoarseMesh</span><span class=o>.</span><span class=n>p</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]))</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>CoarseMesh</span><span class=o>.</span><span class=n>p</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>    <span class=n>xm</span><span class=o>=</span><span class=n>xm_grid</span><span class=p>[:,</span><span class=n>i</span><span class=p>]</span> <span class=c1>#update xm</span>
</span></span><span class=line><span class=cl>    <span class=n>C</span> <span class=o>=</span> <span class=n>compute_C</span><span class=p>(</span><span class=n>xm</span><span class=p>)</span> <span class=c1># find C for normalization</span>
</span></span><span class=line><span class=cl>    <span class=n>qmReducedBasis</span><span class=p>[:,</span><span class=n>i</span><span class=p>]</span><span class=o>=</span><span class=n>qm_b</span><span class=p>(</span><span class=n>xm</span><span class=p>,</span><span class=n>C</span><span class=p>)</span> <span class=c1># generate qm</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl><span class=n>plot</span><span class=p>(</span><span class=n>FineMesh</span><span class=p>,</span> <span class=n>qmReducedBasis</span><span class=p>[:,</span><span class=mi>0</span><span class=p>],</span> <span class=n>shading</span><span class=o>=</span><span class=s1>&#39;gouraud&#39;</span><span class=p>,</span> <span class=n>colorbar</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=n>NumberOfModesM</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>shape</span><span class=p>(</span><span class=n>qmReducedBasis</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span>
</span></span></code></pre></div><p><figure><div class="flex justify-center"><div class=w-100><img src=./pbdw_23_0.png alt=png loading=lazy data-zoomable></div></div></figure></p><p>Now we have two kind of basis functions:</p><ul><li>the $\Phi_i \in \mathcal{Z}_N$ for $i=1,\dots,N$ (in the code bkReducedBasis),</li><li>the $q_j \in \mathcal{U}_M$, for $j=1,\dots,M$ (in the code qmReducedBasis).</li></ul><h4 id=pbdw-algebraic-form>PBDW algebraic form</h4><p>We now state the algebraic form of the PBDW problem.
We need to compute $(A)_{i,j}=(q_i,q_j)$ and $(B)_{i,j}=(\Phi_j,q_i)$ and to assemble $K= \begin{pmatrix} A & B \\
B^T & 0 \end{pmatrix}$ in order to solve $\begin{pmatrix} \eta_M \\ z_N \end{pmatrix} = K^{-1} \begin{pmatrix} y^{obs} \\ 0 \end{pmatrix}$</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;---------------------------------------&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;---- OFFLINE PART: BUILDING MATRICES --&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;---------------------------------------&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>############################################</span>
</span></span><span class=line><span class=cl><span class=c1>## Assembling A and B  #####################</span>
</span></span><span class=line><span class=cl><span class=c1>############################################</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>AMat</span><span class=o>=</span><span class=n>massMat</span>
</span></span><span class=line><span class=cl><span class=n>BMat</span><span class=o>=</span><span class=n>massMat</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#############################################</span>
</span></span><span class=line><span class=cl><span class=c1>## Project matrices onto the reduced space ##</span>
</span></span><span class=line><span class=cl><span class=c1>#############################################</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Areduced</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=n>NumberOfModesM</span><span class=p>,</span> <span class=n>NumberOfModesM</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>Breduced</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=n>NumberOfModesM</span><span class=p>,</span> <span class=n>NumberOfModesN</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>NumberOfModesM</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>MatAVecProduct</span> <span class=o>=</span> <span class=n>AMat</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>qmReducedBasis</span><span class=p>[:,</span><span class=n>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>NumberOfModesM</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>j</span><span class=o>&gt;=</span><span class=n>i</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>Areduced</span><span class=p>[</span><span class=n>i</span><span class=p>,</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>qmReducedBasis</span><span class=p>[:,</span><span class=n>j</span><span class=p>],</span><span class=n>MatAVecProduct</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>Areduced</span><span class=p>[</span><span class=n>j</span><span class=p>,</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>Areduced</span><span class=p>[</span><span class=n>i</span><span class=p>,</span><span class=n>j</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>NumberOfModesM</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>MatBVecProduct</span> <span class=o>=</span> <span class=n>BMat</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>qmReducedBasis</span><span class=p>[:,</span><span class=n>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>NumberOfModesN</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>Breduced</span><span class=p>[</span><span class=n>i</span><span class=p>,</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>bkReducedBasis</span><span class=p>[</span><span class=n>j</span><span class=p>],</span><span class=n>MatBVecProduct</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Kreduced</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=n>NumberOfModesN</span><span class=o>+</span><span class=n>NumberOfModesM</span><span class=p>,</span><span class=n>NumberOfModesN</span><span class=o>+</span> <span class=n>NumberOfModesM</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=c1>#fill global K</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>NumberOfModesM</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>NumberOfModesM</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>Kreduced</span><span class=p>[</span><span class=n>i</span><span class=p>,</span><span class=n>j</span><span class=p>]</span><span class=o>=</span><span class=n>Areduced</span><span class=p>[</span><span class=n>i</span><span class=p>,</span><span class=n>j</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>NumberOfModesM</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>NumberOfModesN</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>Kreduced</span><span class=p>[</span><span class=n>i</span><span class=p>,</span><span class=n>NumberOfModesM</span><span class=o>+</span><span class=n>j</span><span class=p>]</span><span class=o>=</span><span class=n>Breduced</span><span class=p>[</span><span class=n>i</span><span class=p>,</span><span class=n>j</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>Kreduced</span><span class=p>[</span><span class=n>NumberOfModesM</span><span class=o>+</span><span class=n>j</span><span class=p>,</span><span class=n>i</span><span class=p>]</span><span class=o>=</span><span class=n>Breduced</span><span class=p>[</span><span class=n>i</span><span class=p>,</span><span class=n>j</span><span class=p>]</span>
</span></span></code></pre></div><pre><code>---------------------------------------
---- OFFLINE PART: BUILDING MATRICES --
---------------------------------------
</code></pre><h4 id=online-part>ONLINE PART</h4><p>We can now solve $\begin{pmatrix} \eta_M \\ z_N \end{pmatrix} = K^{-1} \begin{pmatrix} y^{obs} \\ 0 \end{pmatrix}$
and we approximate $u^{true}(\mu^{true})$ by $u=\sum_{i=1}^M (\eta_M)_i \ q_i +\sum_{i=1}^N (z_N)_i \ \Phi_i $.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Construct the observations from the basis (qm)_m and the true data</span>
</span></span><span class=line><span class=cl><span class=n>yobs</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>NumberOfModesM</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#mu1=mu1list[1]</span>
</span></span><span class=line><span class=cl><span class=c1>#mu2=mu2list[2]</span>
</span></span><span class=line><span class=cl><span class=c1>#utrue=SolveAdvDiffProblem([mu1,mu2],FineMesh,True)</span>
</span></span><span class=line><span class=cl><span class=c1># Compute (q_m, v)_U</span>
</span></span><span class=line><span class=cl><span class=n>qm_inner</span> <span class=o>=</span><span class=n>utrue</span><span class=o>@</span> <span class=n>massMat</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>NumberOfModesM</span><span class=p>):</span>    
</span></span><span class=line><span class=cl>    <span class=n>yobs</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span><span class=n>qm_inner</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>qmReducedBasis</span><span class=p>[:,</span><span class=n>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;--------------------------------------------&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;---- ONLINE PART: SOLVING REDUCED PROBLEM --&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;--------------------------------------------&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>RightHandSide</span><span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>concatenate</span><span class=p>([</span><span class=n>yobs</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>NumberOfModesN</span><span class=p>)])</span> 
</span></span><span class=line><span class=cl><span class=c1>## SOLVING PROBLEM ##</span>
</span></span><span class=line><span class=cl><span class=c1>#EtaZ=np.linalg.solve(Kreduced,RightHandSide)</span>
</span></span><span class=line><span class=cl><span class=c1>#Eta, Z = EtaZ[:NumberOfModesM],EtaZ[NumberOfModesM:]</span>
</span></span><span class=line><span class=cl><span class=c1>#print(&#34;norm&#34;,np.linalg.norm(Areduced@Eta+Breduced@Z-yobs))</span>
</span></span><span class=line><span class=cl><span class=c1>#print(&#34;norm&#34;,np.linalg.norm(Breduced.transpose()@Eta))</span>
</span></span><span class=line><span class=cl><span class=c1>#u=np.dot(Eta,qmReducedBasis.transpose())+np.dot(Z,bkReducedBasis)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Z</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>solve</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>Breduced</span><span class=o>.</span><span class=n>transpose</span><span class=p>(),</span><span class=n>np</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>inv</span><span class=p>(</span><span class=n>Areduced</span><span class=p>)),</span><span class=n>Breduced</span><span class=p>),</span><span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>Breduced</span><span class=o>.</span><span class=n>transpose</span><span class=p>(),</span><span class=n>np</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>inv</span><span class=p>(</span><span class=n>Areduced</span><span class=p>)),</span><span class=n>yobs</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>Eta</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>solve</span><span class=p>(</span><span class=n>Areduced</span><span class=p>,</span><span class=n>yobs</span><span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>Breduced</span><span class=p>,</span><span class=n>Z</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>u</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>Eta</span><span class=p>,</span><span class=n>qmReducedBasis</span><span class=o>.</span><span class=n>transpose</span><span class=p>())</span><span class=o>+</span><span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>Z</span><span class=p>,</span><span class=n>bkReducedBasis</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ExactSolution</span> <span class=o>=</span><span class=n>utrue</span> <span class=c1>#exact observations</span>
</span></span><span class=line><span class=cl><span class=n>ReconstructedCompressedSolution</span> <span class=o>=</span> <span class=n>u</span> <span class=c1>#reduced solution</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=n>norml2ExactSolution</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>ExactSolution</span><span class=o>@</span><span class=p>(</span><span class=n>L2massMat</span><span class=nd>@ExactSolution</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>normh1ExactSolution</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>ExactSolution</span><span class=o>@</span><span class=p>(</span><span class=n>massMat</span><span class=nd>@ExactSolution</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>t</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>ReconstructedCompressedSolution</span><span class=o>-</span><span class=n>ExactSolution</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>norml2ExactSolution</span> <span class=o>!=</span><span class=mi>0</span> <span class=ow>and</span> <span class=n>normh1ExactSolution</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>relError</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>t</span><span class=nd>@L2massMat@t</span><span class=p>)</span><span class=o>/</span><span class=n>norml2ExactSolution</span>
</span></span><span class=line><span class=cl>    <span class=n>relh1Error</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>t</span><span class=nd>@massMat@t</span><span class=p>)</span><span class=o>/</span><span class=n>normh1ExactSolution</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>relError</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>norm</span><span class=p>(</span><span class=n>ReconstructedCompressedSolution</span><span class=o>-</span><span class=n>ExactSolution</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;L2 relative error: &#34;</span><span class=p>,</span><span class=n>relError</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;H1 relative error: &#34;</span><span class=p>,</span><span class=n>relh1Error</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plot</span><span class=p>(</span><span class=n>FineMesh</span><span class=p>,</span><span class=n>utrue</span><span class=p>,</span> <span class=n>shading</span><span class=o>=</span><span class=s1>&#39;gouraud&#39;</span><span class=p>,</span> <span class=n>colorbar</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plot</span><span class=p>(</span><span class=n>FineMesh</span><span class=p>,</span><span class=n>u</span><span class=p>,</span> <span class=n>shading</span><span class=o>=</span><span class=s1>&#39;gouraud&#39;</span><span class=p>,</span> <span class=n>colorbar</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>#plot(FineMesh,np.dot(Z,bkReducedBasis)-utrue, shading=&#39;gouraud&#39;, colorbar=True)</span>
</span></span><span class=line><span class=cl><span class=n>plot</span><span class=p>(</span><span class=n>FineMesh</span><span class=p>,</span><span class=n>u</span><span class=o>-</span><span class=n>utrue</span><span class=p>,</span> <span class=n>shading</span><span class=o>=</span><span class=s1>&#39;gouraud&#39;</span><span class=p>,</span> <span class=n>colorbar</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span></code></pre></div><pre><code>--------------------------------------------
---- ONLINE PART: SOLVING REDUCED PROBLEM --
--------------------------------------------
L2 relative error:  0.0004129386415760589
H1 relative error:  0.003935527762515732





&lt;Axes: &gt;
</code></pre><p><figure><div class="flex justify-center"><div class=w-100><img src=./pbdw_27_2.png alt=png loading=lazy data-zoomable></div></div></figure></p><p><figure><div class="flex justify-center"><div class=w-100><img src=./pbdw_27_3.png alt=png loading=lazy data-zoomable></div></div></figure></p><p><figure><div class="flex justify-center"><div class=w-100><img src=./pbdw_27_4.png alt=png loading=lazy data-zoomable></div></div></figure></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python></code></pre></div></div><time class="mt-12 mb-8 block text-xs text-gray-500 ltr:text-right rtl:text-left dark:text-gray-400" datetime=2024-12-13T10:19:20.000Z><span>Last updated on</span>
Dec 13, 2024</time><div class="container mx-auto prose prose-slate lg:prose-xl dark:prose-invert mt-5"><div class="max-w-prose print:hidden"><section class="flex flex-row flex-wrap justify-center pt-4 text-xl"><a target=_blank rel=noopener class="m-1 rounded-md bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral-300 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://twitter.com/intent/tweet?url=https%3A%2F%2Freducedbasis.github.io%2Fpost%2Fpbdwadv%2F&amp;text=" title=X aria-label=X id=share-link-x><svg style="height:1em" viewBox="0 0 512 512"><path fill="currentcolor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg>
</a><a target=_blank rel=noopener class="m-1 rounded-md bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral-300 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Freducedbasis.github.io%2Fpost%2Fpbdwadv%2F&amp;t=" title=Facebook aria-label=Facebook id=share-link-facebook><svg style="height:1em" viewBox="0 0 24 24"><path fill="currentcolor" d="M22 12c0-5.52-4.48-10-10-10S2 6.48 2 12c0 4.84 3.44 8.87 8 9.8V15H8v-3h2V9.5C10 7.57 11.57 6 13.5 6H16v3h-2c-.55.0-1 .45-1 1v2h3v3h-3v6.95c5.05-.5 9-4.76 9-9.95z"/></svg>
</a><a target=_blank rel=noopener class="m-1 rounded-md bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral-300 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="mailto:?subject=&amp;body=https%3A%2F%2Freducedbasis.github.io%2Fpost%2Fpbdwadv%2F" title=Email aria-label=Email id=share-link-email><svg style="height:1em" viewBox="0 0 24 24"><path fill="none" stroke="currentcolor" stroke-linecap="round" stroke-width="1.5" d="M16.5 12a4.5 4.5.0 11-9 0 4.5 4.5.0 019 0zm0 0c0 1.657 1.007 3 2.25 3S21 13.657 21 12a9 9 0 10-2.636 6.364M16.5 12V8.25"/></svg>
</a><a target=_blank rel=noopener class="m-1 rounded-md bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral-300 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Freducedbasis.github.io%2Fpost%2Fpbdwadv%2F&amp;title=" title=LinkedIn aria-label=LinkedIn id=share-link-linkedin><svg style="height:1em" height="1em" viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</a><a target=_blank rel=noopener class="m-1 rounded-md bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral-300 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="whatsapp://send?text=%20https%3A%2F%2Freducedbasis.github.io%2Fpost%2Fpbdwadv%2F" title=WhatsApp aria-label=WhatsApp id=share-link-whatsapp><svg style="height:1em" viewBox="0 0 256 256" fill="currentcolor"><path d="m187.58 144.84-32-16a8 8 0 00-8 .5l-14.69 9.8a40.55 40.55.0 01-16-16l9.8-14.69a8 8 0 00.5-8l-16-32A8 8 0 00104 64a40 40 0 00-40 40 88.1 88.1.0 0088 88 40 40 0 0040-40 8 8 0 00-4.42-7.16zM152 176a72.08 72.08.0 01-72-72 24 24 0 0119.29-23.54l11.48 23L101 118a8 8 0 00-.73 7.51 56.47 56.47.0 0030.15 30.15A8 8 0 00138 155l14.61-9.74 23 11.48A24 24 0 01152 176zM128 24A104 104 0 0036.18 176.88l-11.35 34.05a16 16 0 0020.24 20.24l34.05-11.35A104 104 0 10128 24zm0 192a87.87 87.87.0 01-44.06-11.81 8 8 0 00-6.54-.67L40 216l12.47-37.4a8 8 0 00-.66-6.54A88 88 0 11128 216z"/></svg></a></section><div class="flex pt-12 pb-4"><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Authors</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300"></div><div class="text-2xl sm:text-lg pt-1"><div class="flex flex-wrap text-neutral-500 dark:text-neutral-300"><a class="pr-2 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400" style=will-change:transform href=mailto:reducedbases@gmail.com aria-label=At-Symbol><svg style="height:1em" viewBox="0 0 24 24"><path fill="none" stroke="currentcolor" stroke-linecap="round" stroke-width="1.5" d="M16.5 12a4.5 4.5.0 11-9 0 4.5 4.5.0 019 0zm0 0c0 1.657 1.007 3 2.25 3S21 13.657 21 12a9 9 0 10-2.636 6.364M16.5 12V8.25"/></svg></a></div></div></div></div><div class="pt-1 no-prose w-full"><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex flex-col md:flex-row flex-nowrap justify-between gap-5 pt-2"><div><a class="group flex no-underline" href=/post/nirb2grid/><span class="mt-[-0.3rem] me-2 text-neutral-700 transition-transform group-hover:-translate-x-[2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"><span class="ltr:inline rtl:hidden">&larr;</span></span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"></span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">Dec 13, 2024</span></span></a></div><div><a class="group flex text-right no-underline" href=/post/pbdwhelmholtz/><span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"></span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">Dec 13, 2024
</span></span><span class="mt-[-0.3rem] ms-2 text-neutral-700 transition-transform group-hover:-translate-x-[2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"><span class=ltr:inline>&rarr;</span></span></a></div></div></div></div></div></main></article></div></div><div class=page-footer><footer class="container mx-auto flex flex-col justify-items-center text-sm leading-6 mt-24 mb-4 text-slate-700 dark:text-slate-200"><p class="powered-by text-center">Thanks</p><p class="powered-by footer-license-icons"><a href=https://creativecommons.org/licenses/by-nc-nd/4.0 rel="noopener noreferrer" target=_blank aria-label="Creative Commons"><i class="fab fa-creative-commons fa-2x" aria-hidden=true></i>
<i class="fab fa-creative-commons-by fa-2x" aria-hidden=true></i>
<i class="fab fa-creative-commons-nc fa-2x" aria-hidden=true></i>
<i class="fab fa-creative-commons-nd fa-2x" aria-hidden=true></i></a></p><p class="powered-by text-center">Published with <a href="https://hugoblox.com/?utm_campaign=poweredby" target=_blank rel=noopener>Hugo Blox Builder</a> — the free, <a href=https://github.com/HugoBlox/hugo-blox-builder target=_blank rel=noopener>open source</a> website builder that empowers creators.</p></footer></div></body></html>