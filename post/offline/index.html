<!doctype html><!-- This site was created with Hugo Blox. https://hugoblox.com --><!-- Last Published: April 15, 2025 --><html lang=en-us dir=ltr data-wc-theme-default=light><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=generator content="Hugo Blox Builder 0.2.0"><meta name=description content="OFFLINE PART (SVD/POD/Greedy/rSVD&mldr;)
Script by Elise Grosjean (elise.grosjean@ensta-paris.fr)
import sys
!{sys.executable} -m pip install numpy
!{sys.executable} -m pip install matplotlib
!{sys.executable} -m pip install scikit-fem
[1m[[0m[34;49mnotice[0m[1;39;49m][0m[39;49m A new release of pip is available: [0m[31;49m24.1.1[0m[39;49m -> [0m[32;49m25.0.1[0m
[1m[[0m[34;49mnotice[0m[1;39;49m][0m[39;49m To update, run: [0m[32;49mpython3.11 -m pip install --upgrade pip[0m

Let us consider a parameterized problem we want to solve for different parameter values in a set $\mathcal{G}$."><link rel=alternate hreflang=en-us href=https://reducedbasis.github.io/post/offline/><link rel=stylesheet href=/css/themes/blue.min.css><link href=/dist/wc.min.css rel=stylesheet><script>window.hbb={defaultTheme:document.documentElement.dataset.wcThemeDefault,setDarkTheme:()=>{document.documentElement.classList.add("dark"),document.documentElement.style.colorScheme="dark"},setLightTheme:()=>{document.documentElement.classList.remove("dark"),document.documentElement.style.colorScheme="light"}},console.debug(`Default Hugo Blox Builder theme is ${window.hbb.defaultTheme}`),"wc-color-theme"in localStorage?localStorage.getItem("wc-color-theme")==="dark"?window.hbb.setDarkTheme():window.hbb.setLightTheme():(window.hbb.defaultTheme==="dark"?window.hbb.setDarkTheme():window.hbb.setLightTheme(),window.hbb.defaultTheme==="system"&&(window.matchMedia("(prefers-color-scheme: dark)").matches?window.hbb.setDarkTheme():window.hbb.setLightTheme()))</script><script>document.addEventListener("DOMContentLoaded",function(){let e=document.querySelectorAll("li input[type='checkbox'][disabled]");e.forEach(e=>{e.parentElement.parentElement.classList.add("task-list")});const t=document.querySelectorAll(".task-list li");t.forEach(e=>{let t=Array.from(e.childNodes).filter(e=>e.nodeType===3&&e.textContent.trim().length>1);if(t.length>0){const n=document.createElement("label");t[0].after(n),n.appendChild(e.querySelector("input[type='checkbox']")),n.appendChild(t[0])}})})</script><link rel=icon type=image/png href=/media/icon_hu16304263275779960481.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu1534112029185156839.png><link rel=canonical href=https://reducedbasis.github.io/post/offline/><meta property="twitter:card" content="summary"><meta property="twitter:site" content="@GetResearchDev"><meta property="twitter:creator" content="@GetResearchDev"><meta property="og:site_name" content="RBM Docs"><meta property="og:url" content="https://reducedbasis.github.io/post/offline/"><meta property="og:title" content="Offline part | RBM Docs"><meta property="og:description" content="OFFLINE PART (SVD/POD/Greedy/rSVD&mldr;)
Script by Elise Grosjean (elise.grosjean@ensta-paris.fr)
import sys
!{sys.executable} -m pip install numpy
!{sys.executable} -m pip install matplotlib
!{sys.executable} -m pip install scikit-fem
[1m[[0m[34;49mnotice[0m[1;39;49m][0m[39;49m A new release of pip is available: [0m[31;49m24.1.1[0m[39;49m -> [0m[32;49m25.0.1[0m
[1m[[0m[34;49mnotice[0m[1;39;49m][0m[39;49m To update, run: [0m[32;49mpython3.11 -m pip install --upgrade pip[0m

Let us consider a parameterized problem we want to solve for different parameter values in a set $\mathcal{G}$."><meta property="og:image" content="https://reducedbasis.github.io/media/icon_hu8177510199143947247.png"><meta property="twitter:image" content="https://reducedbasis.github.io/media/icon_hu8177510199143947247.png"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2024-12-13T10:19:20+01:00"><meta property="article:modified_time" content="2024-12-13T10:19:20+01:00"><title>Offline part | RBM Docs</title><style>@font-face{font-family:inter var;font-style:normal;font-weight:100 900;font-display:swap;src:url(/dist/font/Inter.var.woff2)format(woff2)}</style><link type=text/css rel=stylesheet href=/dist/pagefind/pagefind-ui.be766eb419317a14ec769d216e9779bfe8f3737c80e780f4ba0dafb57a41a482.css integrity="sha256-vnZutBkxehTsdp0hbpd5v+jzc3yA54D0ug2vtXpBpII="><script src=/dist/pagefind/pagefind-ui.87693d7c6f2b3b347ce359d0ede762c033419f0a32b22ce508c335a81d841f1b.js integrity="sha256-h2k9fG8rOzR841nQ7ediwDNBnwoysizlCMM1qB2EHxs="></script><script>window.hbb.pagefind={baseUrl:"/"}</script><style>html.dark{--pagefind-ui-primary:#eeeeee;--pagefind-ui-text:#eeeeee;--pagefind-ui-background:#152028;--pagefind-ui-border:#152028;--pagefind-ui-tag:#152028}</style><script>window.addEventListener("DOMContentLoaded",e=>{new PagefindUI({element:"#search",showSubResults:!0,baseUrl:window.hbb.pagefind.baseUrl,bundlePath:window.hbb.pagefind.baseUrl+"pagefind/"})}),document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementById("search"),t=document.getElementById("search_toggle");t&&t.addEventListener("click",()=>{if(e.classList.toggle("hidden"),e.querySelector("input").value="",e.querySelector("input").focus(),!e.classList.contains("hidden")){let t=document.querySelector(".pagefind-ui__search-clear");t&&!t.hasAttribute("listenerOnClick")&&(t.setAttribute("listenerOnClick","true"),t.addEventListener("click",()=>{e.classList.toggle("hidden")}))}})})</script><link type=text/css rel=stylesheet href=/dist/lib/katex/katex.min.505d5f829022bb7b4f24dfee0aa1141cd7bba67afe411d1240335f820960b5c3.css integrity="sha256-UF1fgpAiu3tPJN/uCqEUHNe7pnr+QR0SQDNfgglgtcM="><script defer src=/dist/lib/katex/katex.min.dc84b296ec3e884de093158f760fd9d45b6c7abe58b5381557f4e138f46a58ae.js integrity="sha256-3ISyluw+iE3gkxWPdg/Z1Ftser5YtTgVV/ThOPRqWK4="></script><script defer src=/js/katex-renderer.6579ec9683211cfb952064aedf3a3baea5eeb17a061775b32b70917474637c80.js integrity="sha256-ZXnsloMhHPuVIGSu3zo7rqXusXoGF3WzK3CRdHRjfIA="></script><script defer src=/js/hugo-blox-en.min.e5fa931947cac2d947732ea37a770aae2b5bd4a50b6048060cd129b46159a06d.js integrity="sha256-5fqTGUfKwtlHcy6jencKritb1KULYEgGDNEptGFZoG0="></script></head><body class="dark:bg-hb-dark dark:text-white page-wrapper" id=top><div id=page-bg></div><div class="page-header sticky top-0 z-30"><header id=site-header class=header><nav class="navbar px-3 flex justify-left"><div class="order-0 h-100"><a class=navbar-brand href=/ title="RBM Docs"><img fetchpriority=high decoding=async width=49 height=36 src=/media/logo_hu9071661120962382538.webp alt="RBM Docs"></a></div><input id=nav-toggle type=checkbox class=hidden>
<label for=nav-toggle class="order-3 cursor-pointer flex items-center lg:hidden text-dark dark:text-white lg:order-1"><svg id="show-button" class="h-6 fill-current block" viewBox="0 0 20 20"><title>Open Menu</title><path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0V0z"/></svg>
<svg id="hide-button" class="h-6 fill-current hidden" viewBox="0 0 20 20"><title>Close Menu</title><polygon points="11 9 22 9 22 11 11 11 11 22 9 22 9 11 -2 11 -2 9 9 9 9 -2 11 -2" transform="rotate(45 10 10)"/></svg></label><ul id=nav-menu class="navbar-nav order-3 hidden lg:flex w-full pb-6 lg:order-1 lg:w-auto lg:space-x-2 lg:pb-0 xl:space-x-8 justify-left"><li class=nav-item><a class=nav-link href=/>Home</a></li><li class=nav-item><a class=nav-link href=/docs/>Documentation</a></li><li class=nav-item><a class=nav-link href=/blog/>News</a></li><li class=nav-item><a class=nav-link href=/showcase/>Other examples</a></li><li class=nav-item><a class=nav-link href=/events/>Events</a></li><li class="mt-4 inline-block lg:hidden"><a href=/>Get Started</a></li></ul><div class="order-1 ml-auto flex items-center md:order-2 lg:ml-0"><button aria-label=search class="text-black hover:text-primary inline-block px-3 text-xl dark:text-white" id=search_toggle>
<svg height="16" width="16" viewBox="0 0 512 512" fill="currentcolor"><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8.0 45.3s-32.8 12.5-45.3.0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9.0 208S93.1.0 208 0 416 93.1 416 208zM208 352a144 144 0 100-288 144 144 0 100 288z"/></svg></button><div class="px-3 text-black hover:text-primary-700 dark:text-white dark:hover:text-primary-300
[&.active]:font-bold [&.active]:text-black/90 dark:[&.active]:text-white"><button class="theme-toggle mt-1" accesskey=t title=appearance>
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="dark:hidden"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="dark:block [&:not(dark)]:hidden"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div><a href=/ class="inline-block rounded border px-5 py-2 font-semibold transition
md:ml-4 px-4 py-1.5 text-sm
border-black hover:bg-black dark:hover:bg-white dark:hover:text-black hover:text-white dark:border-white dark:text-white dark:hover:bg-white
hidden lg:inline-block">Get Started</a></div></nav></header><div id=search class="hidden p-3"></div></div><div class="page-body my-10"><div class="mx-auto flex max-w-screen-xl"><aside class="hb-sidebar-container max-lg:[transform:translate3d(0,-100%,0)] lg:hidden xl:block"><div class="px-4 pt-4 lg:hidden"></div><div class="hb-scrollbar lg:h-[calc(100vh-var(--navbar-height))]"><ul class="flex flex-col gap-1 lg:hidden"><li class=open><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/post/>Posts
<span data-hb-sidebar-toggle><svg fill="none" viewBox="0 0 24 24" stroke="currentcolor" class="h-[18px] min-w-[18px] rounded-sm p-0.5 hover:bg-gray-800/5 dark:hover:bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="origin-center transition-transform rtl:-rotate-180"/></svg></span></a><div class="ltr:pr-0 overflow-hidden"><ul class=hb-sidebar-list><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/post/eim/>index</a></li><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/post/nirb2grid/>index</a></li><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/post/pbdwadv/>index</a></li><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/post/pbdwhelmholtz/>index</a></li><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/post/podgalerkin/>index</a></li><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/post/podi/>index</a></li><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/post/pbdw/>My Post</a></li><li class="flex flex-col open"><a class="hb-sidebar-custom-link
sidebar-active-item bg-primary-100 font-semibold text-primary-800 dark:bg-primary-300 dark:text-primary-900" href=/post/offline/>Offline part</a><ul class=hb-sidebar-mobile-toc><li><a href=#1-the-2d-driven-cavity-problem class=hb-docs-link>1) The 2D-driven cavity problem:</a></li><li><a href=#2-the-reduced-basis-rb-construction class=hb-docs-link>2) The Reduced Basis (RB) construction:</a></li><li><a href=#1-snapshot-proper-orthogonal-decomposition-snapshot-pod class=hb-docs-link>1. Snapshot Proper Orthogonal Decomposition (Snapshot-POD)</a></li><li><a href=#2-greedy-algorithm class=hb-docs-link>2. Greedy algorithm</a></li><li><a href=#3-rpod-random-pod class=hb-docs-link>3. rPOD (random POD)</a></li><li><a href=#4-truncated-svd class=hb-docs-link>4. Truncated SVD</a></li><li><a href=#5-random-svd-rsvd class=hb-docs-link>5. Random SVD (rSVD)</a></li></ul></li><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/post/rsvd/>random Singular Value Decomposition</a></li><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/post/poddlrom/>The POD-DL-ROM</a></li></ul></div></li><li><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/blog/>Recent and Upcoming methods
<span data-hb-sidebar-toggle><svg fill="none" viewBox="0 0 24 24" stroke="currentcolor" class="h-[18px] min-w-[18px] rounded-sm p-0.5 hover:bg-gray-800/5 dark:hover:bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="origin-center transition-transform rtl:-rotate-180"/></svg></span></a><div class="ltr:pr-0 overflow-hidden"><ul class=hb-sidebar-list><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/blog/v1.0.0/>PBDW v1 released!</a></li><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/blog/v2.0.0/>POD-DL-ROM released!</a></li><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/blog/todolist/>TODO list</a></li></ul></div></li><li><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/showcase/>More applications
<span data-hb-sidebar-toggle><svg fill="none" viewBox="0 0 24 24" stroke="currentcolor" class="h-[18px] min-w-[18px] rounded-sm p-0.5 hover:bg-gray-800/5 dark:hover:bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="origin-center transition-transform rtl:-rotate-180"/></svg></span></a><div class="ltr:pr-0 overflow-hidden"><ul class=hb-sidebar-list><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/showcase/cavity/>Cavity</a></li></ul></div></li><li><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/docs/>Documentation
<span data-hb-sidebar-toggle><svg fill="none" viewBox="0 0 24 24" stroke="currentcolor" class="h-[18px] min-w-[18px] rounded-sm p-0.5 hover:bg-gray-800/5 dark:hover:bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="origin-center transition-transform rtl:-rotate-180"/></svg></span></a><div class="ltr:pr-0 overflow-hidden"><ul class=hb-sidebar-list><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/docs/poddlrom/>POD-DL-ROM</a></li><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/docs/pod/>POD-Galerkin</a></li><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/docs/podi/>POD-Interpolation</a></li><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/docs/eim/>EIM</a></li><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/docs/nirb2grid/>NIRB 2-grid</a></li><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/docs/pbdw/>PBDW</a></li><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/docs/reference/>References</a></li></ul></div></li><li><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/events/>Events</a></li></ul><div class="max-xl:hidden h-0 w-64 shrink-0"></div></div></aside><nav class="hb-toc order-last hidden w-64 shrink-0 xl:block print:hidden px-4" aria-label="table of contents"><div class="hb-scrollbar text-sm [hyphens:auto] sticky top-16 overflow-y-auto pr-4 pt-6 max-h-[calc(100vh-var(--navbar-height)-env(safe-area-inset-bottom))] -mr-4 rtl:-ml-4"><p class="mb-4 font-semibold tracking-tight">On this page</p><ul><li class="my-2 scroll-my-6 scroll-py-6"><a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#1-the-2d-driven-cavity-problem>1) The 2D-driven cavity problem:</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#2-the-reduced-basis-rb-construction>2) The Reduced Basis (RB) construction:</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#1-snapshot-proper-orthogonal-decomposition-snapshot-pod>1. Snapshot Proper Orthogonal Decomposition (Snapshot-POD)</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="pl-8 rtl:pr-8 inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#cost>cost</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#2-greedy-algorithm>2. Greedy algorithm</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="pl-8 rtl:pr-8 inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#cost-1>cost</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#3-rpod-random-pod>3. rPOD (random POD)</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="pl-8 rtl:pr-8 inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#cost-2>cost</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#4-truncated-svd>4. Truncated SVD</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="pl-8 rtl:pr-8 inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#cost-3>cost</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#5-random-svd-rsvd>5. Random SVD (rSVD)</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="pl-8 rtl:pr-8 inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#cost-4>cost</a></li></ul><div class=backlinks><div class="mb-1 font-semibold tracking-tight">Backlinks</div><ul><li><a href=/docs/ class=backlink>Documentation</a></li></ul></div></div></nav><article class="w-full break-words flex min-h-[calc(100vh-var(--navbar-height))] min-w-0 justify-center pb-8 pr-[calc(env(safe-area-inset-right)-1.5rem)]"><main class="w-full min-w-0 max-w-6xl px-6 pt-4 md:px-12"><h1 class="mt-2 text-4xl font-bold tracking-tight text-slate-900 dark:text-slate-100">Offline part</h1><div class="mt-4 mb-16"><div class="text-gray-500 dark:text-gray-300 text-sm flex items-center flex-wrap gap-y-2"><span class=mr-1>Dec 13, 2024</span>
<span class=mx-1>·</span>
<span class=mx-1>16 min read</span></div><div class=mt-3></div></div><div class="prose prose-slate lg:prose-xl dark:prose-invert"><h1 id=offline-part-svdpodgreedyrsvd>OFFLINE PART (SVD/POD/Greedy/rSVD&mldr;)</h1><p>Script by Elise Grosjean (<a href=mailto:elise.grosjean@ensta-paris.fr>elise.grosjean@ensta-paris.fr</a>)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span>
</span></span><span class=line><span class=cl><span class=err>!</span><span class=p>{</span><span class=n>sys</span><span class=o>.</span><span class=n>executable</span><span class=p>}</span> <span class=o>-</span><span class=n>m</span> <span class=n>pip</span> <span class=n>install</span> <span class=n>numpy</span>
</span></span><span class=line><span class=cl><span class=err>!</span><span class=p>{</span><span class=n>sys</span><span class=o>.</span><span class=n>executable</span><span class=p>}</span> <span class=o>-</span><span class=n>m</span> <span class=n>pip</span> <span class=n>install</span> <span class=n>matplotlib</span>
</span></span><span class=line><span class=cl><span class=err>!</span><span class=p>{</span><span class=n>sys</span><span class=o>.</span><span class=n>executable</span><span class=p>}</span> <span class=o>-</span><span class=n>m</span> <span class=n>pip</span> <span class=n>install</span> <span class=n>scikit</span><span class=o>-</span><span class=n>fem</span>
</span></span></code></pre></div><pre><code>[1m[[0m[34;49mnotice[0m[1;39;49m][0m[39;49m A new release of pip is available: [0m[31;49m24.1.1[0m[39;49m -&gt; [0m[32;49m25.0.1[0m
[1m[[0m[34;49mnotice[0m[1;39;49m][0m[39;49m To update, run: [0m[32;49mpython3.11 -m pip install --upgrade pip[0m
</code></pre><p>Let us consider a parameterized problem we want to solve for different parameter values in a set $\mathcal{G}$.</p><p>In general, Reduced Basis Methods (RBM) are decomposed in two stages:</p><ul><li>one offline that generates a smaller subspace $X_h^N$ of dimension $N$,</li><li>and one online that find an approximation for a new parameter $\mu \in \mathcal{G}$ onto that subspace.</li></ul><p>The offline stage is usually very costly but only executed once.
In what follows, we review different algorithms that we can use to compute a reduced basis of $X_h^N$ and compare their computational costs.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># import packages</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>skfem</span>  <span class=c1># for Finite Element Method</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sklearn.utils.extmath</span> <span class=kn>import</span> <span class=n>randomized_svd</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span></code></pre></div><h2 id=1-the-2d-driven-cavity-problem>1) The 2D-driven cavity problem:</h2>$$\begin{align*}
&-\nu \Delta u + (u \cdot \nabla) u + \nabla p =0, \textrm{ in } \Omega,\\
& \nabla. u=0, \textrm{ in } \Omega,\\
& (u_1,u_2)=(1,0), \textrm{ on } \Omega_{up}:=\partial \Omega \cap \{y=1\},\\
& (u_1,u_2)=(0,0), \textrm{ on } \partial \Omega \backslash \Omega_{up},
\end{align*}$$$$\begin{equation*}
\nu (\nabla u^k, \nabla v) + ((u^{k-1} \cdot \nabla) u^k,v) - (p^k, \nabla \cdot v) - (q, \nabla \cdot u^k) + 10^{-10} (p^k, q) =0, \textrm{in } \Omega,
\end{equation*}$$<p>where $u^{k-1}$ is the previous step solution, and we iterate until a threshold is reached (until $\|u^{k}-u^{k-1}\| < \varepsilon $).
Here, with the term $ 10^{-10} (p^k, q) $, we impose the average of the pressure $\int_{\Omega} p^k $ to be equal to $0$. For more details on how we derive this formulation, visit the link : <a href=https://github.com/grosjean1/navierStokes target=_blank rel=noopener>https://github.com/grosjean1/navierStokes</a> (FEM.pdf).</p><p>We employ Taylor-Hood elements to get a proper solution (e.g. P2-P1 for the tuple velocity-pressure) and obtain the system $\mathbf{K} \mathbf{x} =\mathbf{f}$ to solve where $\mathbf{K}= \begin{pmatrix}
\mathbf{A} & -\mathbf{B}^T\\
-\mathbf{B} & 10^{-10} \mathbf{C}
\end{pmatrix}$, $\mathbf{x}$ stands for the tuple velocity-pressure $(u_1^k,u_2^k,p^k)$, and where the assembled matrix $\mathbf{A}$ corresponds to the bilinear part $ \nu (\nabla u^k, \nabla v) + ((u^{k-1} \cdot \nabla) u^k),v) $, the matrix $ B$ to the bilinear part $( p^k ,\nabla \cdot v)$ and $\mathbf{C}$ is the mass matrix applied to the pressure variable ($(\cdot,\cdot)$ represents either the $L^2$ inner-product onto the velocity space or onto the pressure space).</p><p>The dirichlet boundary conditions are imposed with a penalization method, called with scikit-FEM by the line:</p><p>solve(*condense(K,f, x=uvp, D=D)),</p><p>where x=uvp gives the values at the boundaries of the velocity and D refers to the boundary decomposition.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># First we define a mesh for the unit square</span>
</span></span><span class=line><span class=cl><span class=n>mesh</span><span class=o>=</span> <span class=n>skfem</span><span class=o>.</span><span class=n>MeshTri</span><span class=p>()</span><span class=o>.</span><span class=n>refined</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span><span class=o>.</span><span class=n>with_boundaries</span><span class=p>(</span>                                                                
</span></span><span class=line><span class=cl>        <span class=p>{</span>                                                                                                                                
</span></span><span class=line><span class=cl>            <span class=s2>&#34;left&#34;</span><span class=p>:</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>,</span>                                                                                            
</span></span><span class=line><span class=cl>            <span class=s2>&#34;right&#34;</span><span class=p>:</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span><span class=p>,</span>            
</span></span><span class=line><span class=cl>            <span class=s2>&#34;down&#34;</span><span class=p>:</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>,</span>                                                                                            
</span></span><span class=line><span class=cl>            <span class=s2>&#34;up&#34;</span><span class=p>:</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span><span class=p>,</span>     
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=p>}</span>                                                                                                                               
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>mesh</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>mesh</span>
</span></span></code></pre></div><pre><code>&lt;skfem MeshTri1 object&gt;
  Number of elements: 2048
  Number of vertices: 1089
  Number of nodes: 1089
  Named boundaries [# facets]: left [32], bottom [32], right [32], top [32], down [32], up [32]
</code></pre><p><figure><div class="flex justify-center"><div class=w-100><img src=./SVDvsPOD_5_1.svg alt=svg loading=lazy data-zoomable></div></div></figure></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;First step.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Assembling matrices</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>skfem.assembly</span> <span class=kn>import</span> <span class=n>BilinearForm</span><span class=p>,</span> <span class=n>LinearForm</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>skfem.helpers</span> <span class=kn>import</span> <span class=n>grad</span><span class=p>,</span> <span class=n>dot</span><span class=p>,</span><span class=n>div</span><span class=p>,</span><span class=n>ddot</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@BilinearForm</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>laplace</span><span class=p>(</span><span class=n>u</span><span class=p>,</span> <span class=n>v</span><span class=p>,</span> <span class=n>_</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;gradula&#34;</span><span class=p>,</span><span class=n>np</span><span class=o>.</span><span class=n>shape</span><span class=p>(</span><span class=n>grad</span><span class=p>(</span><span class=n>u</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>dot</span><span class=p>(</span><span class=n>grad</span><span class=p>(</span><span class=n>u</span><span class=p>),</span> <span class=n>grad</span><span class=p>(</span><span class=n>v</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@BilinearForm</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>vector_laplace</span><span class=p>(</span><span class=n>u</span><span class=p>,</span> <span class=n>v</span><span class=p>,</span> <span class=n>w</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># same as laplace but for u,v vectors </span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>w</span><span class=o>.</span><span class=n>nu</span><span class=o>*</span><span class=n>ddot</span><span class=p>(</span><span class=n>grad</span><span class=p>(</span><span class=n>u</span><span class=p>),</span> <span class=n>grad</span><span class=p>(</span><span class=n>v</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@BilinearForm</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>mass</span><span class=p>(</span><span class=n>u</span><span class=p>,</span> <span class=n>v</span><span class=p>,</span> <span class=n>_</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>u</span> <span class=o>*</span> <span class=n>v</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@BilinearForm</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>divu</span><span class=p>(</span><span class=n>u</span><span class=p>,</span> <span class=n>v</span><span class=p>,</span> <span class=n>w</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>div</span><span class=p>(</span><span class=n>u</span><span class=p>)</span> <span class=o>*</span> <span class=n>v</span>
</span></span><span class=line><span class=cl><span class=n>divergence</span> <span class=o>=</span> <span class=n>divu</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=c1>#z=w.up*u.grad[0] + w.up * u.grad[1] #(u^(k-1). grad u^k). v</span>
</span></span><span class=line><span class=cl><span class=nd>@BilinearForm</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>nonlinearterm</span><span class=p>(</span><span class=n>u</span><span class=p>,</span> <span class=n>v</span><span class=p>,</span> <span class=n>w</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>up_x</span><span class=p>,</span> <span class=n>up_y</span> <span class=o>=</span> <span class=n>w</span><span class=o>.</span><span class=n>up</span> 
</span></span><span class=line><span class=cl>    <span class=n>v_x</span><span class=p>,</span><span class=n>v_y</span><span class=o>=</span><span class=n>v</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=n>v</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>gradu</span><span class=o>=</span><span class=n>grad</span><span class=p>(</span><span class=n>u</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>gradxu_x</span><span class=o>=</span><span class=n>gradu</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>]</span> 
</span></span><span class=line><span class=cl>    <span class=n>gradxu_y</span><span class=o>=</span><span class=n>gradu</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>gradyu_x</span><span class=o>=</span><span class=n>gradu</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>gradyu_y</span><span class=o>=</span><span class=n>gradu</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>(</span><span class=n>up_x</span><span class=o>*</span><span class=n>gradxu_x</span><span class=o>+</span><span class=n>up_y</span><span class=o>*</span><span class=n>gradxu_y</span><span class=p>)</span><span class=o>*</span><span class=n>v_x</span> <span class=o>+</span> <span class=p>(</span><span class=n>up_x</span><span class=o>*</span><span class=n>gradyu_x</span><span class=o>+</span><span class=n>up_y</span><span class=o>*</span><span class=n>gradyu_y</span><span class=p>)</span><span class=o>*</span><span class=n>v_y</span>
</span></span><span class=line><span class=cl>  
</span></span></code></pre></div><p>In the 2D-driven cavity problem, the parameter of interest is the Reynolds number. In the code below, the function SolveCavityProblem(Re,Mesh) takes as parameters the Reynolds number and a mesh, and returns the associated solution (velocity-pressure).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34; Finally we solve the problem &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>skfem</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=c1># Compute solution of the 2d-driven cavity problem</span>
</span></span><span class=line><span class=cl><span class=n>element</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;u&#39;</span><span class=p>:</span> <span class=n>ElementVector</span><span class=p>(</span><span class=n>ElementTriP2</span><span class=p>()),</span>
</span></span><span class=line><span class=cl>           <span class=s1>&#39;p&#39;</span><span class=p>:</span> <span class=n>ElementTriP1</span><span class=p>()}</span> <span class=c1>#[u,v,p]= velocity-pressure with Taylor-Hood P2-P1 FEM elements</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>SolveCavityProblem</span><span class=p>(</span><span class=n>Re</span><span class=p>,</span><span class=n>Mesh</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># Re is the reynolds parameter #</span>
</span></span><span class=line><span class=cl>    <span class=n>Nu</span><span class=o>=</span><span class=mf>1.</span><span class=o>/</span><span class=n>Re</span> 
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Parameter nu:&#39;</span><span class=p>,</span><span class=n>Nu</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>basis</span> <span class=o>=</span> <span class=p>{</span><span class=n>variable</span><span class=p>:</span> <span class=n>Basis</span><span class=p>(</span><span class=n>Mesh</span><span class=p>,</span> <span class=n>e</span><span class=p>,</span> <span class=n>intorder</span><span class=o>=</span><span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=k>for</span> <span class=n>variable</span><span class=p>,</span> <span class=n>e</span> <span class=ow>in</span> <span class=n>element</span><span class=o>.</span><span class=n>items</span><span class=p>()}</span> <span class=c1># FEM space</span>
</span></span><span class=line><span class=cl>    <span class=n>up</span><span class=o>=</span><span class=n>basis</span><span class=p>[</span><span class=s1>&#39;u&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>zeros</span><span class=p>()</span> <span class=c1>#initialization for non-linear term previous solution</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>B</span> <span class=o>=</span><span class=n>divu</span><span class=o>.</span><span class=n>assemble</span><span class=p>(</span> <span class=n>basis</span><span class=p>[</span><span class=s1>&#39;u&#39;</span><span class=p>],</span> <span class=n>basis</span><span class=p>[</span><span class=s1>&#39;p&#39;</span><span class=p>])</span> <span class=c1># B.T=p*div(v) and B=q *div(u) with q=pressure test function</span>
</span></span><span class=line><span class=cl>    <span class=n>C</span> <span class=o>=</span> <span class=n>mass</span><span class=o>.</span><span class=n>assemble</span><span class=p>(</span><span class=n>basis</span><span class=p>[</span><span class=s1>&#39;p&#39;</span><span class=p>],</span><span class=n>basis</span><span class=p>[</span><span class=s1>&#39;p&#39;</span><span class=p>]</span> <span class=p>)</span> <span class=c1># 1^-10 * p*q impose pressure average equal to 0.</span>
</span></span><span class=line><span class=cl>    <span class=n>A1</span> <span class=o>=</span><span class=n>vector_laplace</span><span class=o>.</span><span class=n>assemble</span><span class=p>(</span><span class=n>basis</span><span class=p>[</span><span class=s1>&#39;u&#39;</span><span class=p>],</span><span class=n>nu</span><span class=o>=</span><span class=n>Nu</span><span class=p>)</span> <span class=c1># nu* grad(u) * grad(v) with u=[u1,u2] and v is test function v=[v1,v2]</span>
</span></span><span class=line><span class=cl>    <span class=c1>#A2=nonlinearterm.assemble(basis[&#39;u&#39;],up=basis[&#39;u&#39;].interpolate(up)) #(u^(k-1). grad u^k). v</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># global matrix Stokes</span>
</span></span><span class=line><span class=cl>    <span class=n>K</span> <span class=o>=</span> <span class=n>bmat</span><span class=p>([[</span><span class=n>A1</span><span class=p>,</span> <span class=o>-</span><span class=n>B</span><span class=o>.</span><span class=n>T</span><span class=p>],</span>
</span></span><span class=line><span class=cl>          <span class=p>[</span><span class=o>-</span><span class=n>B</span><span class=p>,</span> <span class=mf>1e-10</span> <span class=o>*</span> <span class=n>C</span><span class=p>]],</span> <span class=s1>&#39;csr&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>profil_up</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;return u=(0,1) at the up boundary and (0,0) otherwise &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>stack</span><span class=p>([</span><span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>==</span><span class=mi>1</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span><span class=n>x</span><span class=p>[</span><span class=mi>0</span><span class=p>])])</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>up_basis</span> <span class=o>=</span> <span class=n>FacetBasis</span><span class=p>(</span><span class=n>Mesh</span><span class=p>,</span> <span class=n>element</span><span class=p>[</span><span class=s1>&#39;u&#39;</span><span class=p>],</span> <span class=n>facets</span><span class=o>=</span><span class=n>Mesh</span><span class=o>.</span><span class=n>boundaries</span><span class=p>[</span><span class=s1>&#39;up&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>all_basis</span> <span class=o>=</span> <span class=n>FacetBasis</span><span class=p>(</span><span class=n>Mesh</span><span class=p>,</span> <span class=n>element</span><span class=p>[</span><span class=s1>&#39;u&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>uvp_boundary</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>((</span>
</span></span><span class=line><span class=cl>        <span class=n>all_basis</span><span class=o>.</span><span class=n>project</span><span class=p>(</span><span class=n>profil_up</span><span class=p>),</span> <span class=c1># can be replaced by all_basis.project(profil_up), will be 0 by default for the other boundaries</span>
</span></span><span class=line><span class=cl>        <span class=n>basis</span><span class=p>[</span><span class=s1>&#39;p&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>zeros</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>    <span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>D</span> <span class=o>=</span> <span class=n>basis</span><span class=p>[</span><span class=s1>&#39;u&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>get_dofs</span><span class=p>([</span><span class=s1>&#39;up&#39;</span><span class=p>,</span> <span class=s1>&#39;down&#39;</span><span class=p>,</span> <span class=s1>&#39;right&#39;</span><span class=p>,</span><span class=s1>&#39;left&#39;</span><span class=p>])</span> <span class=c1># since we put D on basis[&#39;u&#39;], there will be no penalization on pressure</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>concatenate</span><span class=p>([</span><span class=n>basis</span><span class=p>[</span><span class=s1>&#39;u&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>zeros</span><span class=p>(),</span><span class=n>basis</span><span class=p>[</span><span class=s1>&#39;p&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>zeros</span><span class=p>()])</span> <span class=c1># =0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>#######################</span>
</span></span><span class=line><span class=cl>    <span class=c1>### SOLVING PROBLEM ###</span>
</span></span><span class=line><span class=cl>    <span class=c1>#######################</span>
</span></span><span class=line><span class=cl>    <span class=n>uvp</span> <span class=o>=</span> <span class=n>solve</span><span class=p>(</span><span class=o>*</span><span class=n>condense</span><span class=p>(</span><span class=n>K</span><span class=p>,</span><span class=n>f</span><span class=p>,</span> <span class=n>x</span><span class=o>=</span><span class=n>uvp_boundary</span><span class=p>,</span> <span class=n>D</span><span class=o>=</span><span class=n>D</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>velocity</span><span class=p>,</span> <span class=n>pressure</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>uvp</span><span class=p>,</span> <span class=n>K</span><span class=o>.</span><span class=n>blocks</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>15</span><span class=p>):</span> <span class=c1>#fixed-point iterations</span>
</span></span><span class=line><span class=cl>        <span class=n>up</span><span class=o>=</span><span class=n>velocity</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span> <span class=c1># updating velocity</span>
</span></span><span class=line><span class=cl>        <span class=n>A2</span><span class=o>=</span><span class=n>nonlinearterm</span><span class=o>.</span><span class=n>assemble</span><span class=p>(</span><span class=n>basis</span><span class=p>[</span><span class=s1>&#39;u&#39;</span><span class=p>],</span><span class=n>up</span><span class=o>=</span><span class=n>basis</span><span class=p>[</span><span class=s1>&#39;u&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>interpolate</span><span class=p>(</span><span class=n>up</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>     
</span></span><span class=line><span class=cl>        <span class=c1># global matrix assembling update</span>
</span></span><span class=line><span class=cl>        <span class=n>K</span> <span class=o>=</span> <span class=n>bmat</span><span class=p>([[</span><span class=n>A1</span><span class=o>+</span><span class=n>A2</span><span class=p>,</span> <span class=o>-</span><span class=n>B</span><span class=o>.</span><span class=n>T</span><span class=p>],</span>
</span></span><span class=line><span class=cl>          <span class=p>[</span><span class=o>-</span><span class=n>B</span><span class=p>,</span> <span class=mf>1e-10</span> <span class=o>*</span> <span class=n>C</span><span class=p>]],</span> <span class=s1>&#39;csr&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>uvp</span> <span class=o>=</span> <span class=n>solve</span><span class=p>(</span><span class=o>*</span><span class=n>condense</span><span class=p>(</span><span class=n>K</span><span class=p>,</span><span class=n>f</span><span class=p>,</span> <span class=n>x</span><span class=o>=</span><span class=n>uvp_boundary</span><span class=p>,</span> <span class=n>D</span><span class=o>=</span><span class=n>D</span><span class=p>))</span>
</span></span><span class=line><span class=cl>     
</span></span><span class=line><span class=cl>        <span class=n>velocity</span><span class=p>,</span> <span class=n>pressure</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>uvp</span><span class=p>,</span> <span class=n>K</span><span class=o>.</span><span class=n>blocks</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>velocity</span><span class=p>,</span><span class=n>pressure</span>
</span></span><span class=line><span class=cl>    
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34; We may visualize the solutions &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>skfem.visuals.matplotlib</span> <span class=kn>import</span> <span class=n>plot</span><span class=p>,</span> <span class=n>draw</span><span class=p>,</span> <span class=n>savefig</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>velocity</span><span class=p>,</span><span class=n>pressure</span><span class=o>=</span><span class=n>SolveCavityProblem</span><span class=p>(</span><span class=mi>150</span><span class=p>,</span><span class=n>mesh</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>visualize_pressure</span><span class=p>(</span><span class=n>Mesh</span><span class=p>,</span><span class=n>Pressure</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1>## Function that allows us to visualize the pressure</span>
</span></span><span class=line><span class=cl>    <span class=c1>#from skfem.visuals.matplotlib import plot</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>plot</span><span class=p>(</span><span class=n>Mesh</span><span class=p>,</span> <span class=n>Pressure</span><span class=p>,</span> <span class=n>shading</span><span class=o>=</span><span class=s1>&#39;gouraud&#39;</span><span class=p>,</span> <span class=n>colorbar</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=n>visualize_pressure</span><span class=p>(</span><span class=n>mesh</span><span class=p>,</span><span class=n>pressure</span><span class=p>)</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>visualize_velocity</span><span class=p>(</span><span class=n>Mesh</span><span class=p>,</span><span class=n>Velocity</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1>## Function that allows us to visualize the velocity</span>
</span></span><span class=line><span class=cl>    <span class=n>fig</span><span class=p>,</span> <span class=n>ax</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Calculate the magnitude of velocity</span>
</span></span><span class=line><span class=cl>    <span class=n>basis</span> <span class=o>=</span> <span class=p>{</span><span class=n>variable</span><span class=p>:</span> <span class=n>Basis</span><span class=p>(</span><span class=n>Mesh</span><span class=p>,</span> <span class=n>e</span><span class=p>,</span> <span class=n>intorder</span><span class=o>=</span><span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>variable</span><span class=p>,</span> <span class=n>e</span> <span class=ow>in</span> <span class=n>element</span><span class=o>.</span><span class=n>items</span><span class=p>()}</span> <span class=c1># FEM space</span>
</span></span><span class=line><span class=cl>    <span class=n>velocity1</span> <span class=o>=</span> <span class=n>Velocity</span><span class=p>[</span><span class=n>basis</span><span class=p>[</span><span class=s1>&#39;u&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>nodal_dofs</span><span class=p>]</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>magnitude</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>velocity1</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>**</span><span class=mi>2</span> <span class=o>+</span> <span class=n>velocity1</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>**</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Display the velocity fields with colors for magnitude</span>
</span></span><span class=line><span class=cl>    <span class=n>quiver</span> <span class=o>=</span> <span class=n>ax</span><span class=o>.</span><span class=n>quiver</span><span class=p>(</span><span class=o>*</span><span class=n>mesh</span><span class=o>.</span><span class=n>p</span><span class=p>,</span> <span class=o>*</span><span class=n>velocity1</span><span class=p>,</span> <span class=n>magnitude</span><span class=p>,</span> <span class=n>angles</span><span class=o>=</span><span class=s1>&#39;xy&#39;</span><span class=p>,</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>&#39;jet&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># colorbar</span>
</span></span><span class=line><span class=cl>    <span class=n>cbar</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>colorbar</span><span class=p>(</span><span class=n>quiver</span><span class=p>,</span> <span class=n>ax</span><span class=o>=</span><span class=n>ax</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Limits of axis for the mesh</span>
</span></span><span class=line><span class=cl>    <span class=n>ax</span><span class=o>.</span><span class=n>set_xlim</span><span class=p>([</span><span class=n>Mesh</span><span class=o>.</span><span class=n>p</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>min</span><span class=p>(),</span> <span class=n>Mesh</span><span class=o>.</span><span class=n>p</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>max</span><span class=p>()])</span>
</span></span><span class=line><span class=cl>    <span class=n>ax</span><span class=o>.</span><span class=n>set_ylim</span><span class=p>([</span><span class=n>Mesh</span><span class=o>.</span><span class=n>p</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>min</span><span class=p>(),</span> <span class=n>Mesh</span><span class=o>.</span><span class=n>p</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>max</span><span class=p>()])</span>
</span></span><span class=line><span class=cl>    <span class=n>cbar</span><span class=o>.</span><span class=n>set_label</span><span class=p>(</span><span class=s1>&#39;Velocity magnitude&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># show results</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>visualize_velocity</span><span class=p>(</span><span class=n>mesh</span><span class=p>,</span><span class=n>velocity</span><span class=p>)</span>
</span></span></code></pre></div><pre><code>Parameter nu: 0.006666666666666667
</code></pre><p><figure><div class="flex justify-center"><div class=w-100><img src=./SVDvsPOD_9_1.png alt=png loading=lazy data-zoomable></div></div></figure></p><p><figure><div class="flex justify-center"><div class=w-100><img src=./SVDvsPOD_9_2.png alt=png loading=lazy data-zoomable></div></div></figure></p><h2 id=2-the-reduced-basis-rb-construction>2) The Reduced Basis (RB) construction:</h2><p>For all the methods listed below, we need a fine mesh and the generation of snapshots:
We decompose the snapshots by one average over the parameters and by one fluctuation part. Then, the modes are estimated with the fluctuations.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>## FINE MESH</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>FineMesh</span> <span class=o>=</span> <span class=n>skfem</span><span class=o>.</span><span class=n>MeshTri</span><span class=p>()</span><span class=o>.</span><span class=n>refined</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span><span class=o>.</span><span class=n>with_boundaries</span><span class=p>(</span>                                                                
</span></span><span class=line><span class=cl>        <span class=p>{</span>                                                                                                                                
</span></span><span class=line><span class=cl>            <span class=s2>&#34;left&#34;</span><span class=p>:</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>,</span>                                                                                            
</span></span><span class=line><span class=cl>            <span class=s2>&#34;right&#34;</span><span class=p>:</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span><span class=p>,</span>            
</span></span><span class=line><span class=cl>            <span class=s2>&#34;down&#34;</span><span class=p>:</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>,</span>                                                                                            
</span></span><span class=line><span class=cl>            <span class=s2>&#34;up&#34;</span><span class=p>:</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span><span class=p>,</span>     
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=p>}</span>                                                                                                                               
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>FineBasis</span> <span class=o>=</span> <span class=p>{</span><span class=n>variable</span><span class=p>:</span> <span class=n>Basis</span><span class=p>(</span><span class=n>FineMesh</span><span class=p>,</span> <span class=n>e</span><span class=p>,</span> <span class=n>intorder</span><span class=o>=</span><span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>variable</span><span class=p>,</span> <span class=n>e</span> <span class=ow>in</span> <span class=n>element</span><span class=o>.</span><span class=n>items</span><span class=p>()}</span> <span class=c1># FEM space</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>NumberOfNodesFineMesh</span> <span class=o>=</span> <span class=n>FineMesh</span><span class=o>.</span><span class=n>p</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;number of fine nodes: &#34;</span><span class=p>,</span><span class=n>NumberOfNodesFineMesh</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>#num_dofs_uFineMesh = basis[&#39;u&#39;].doflocs.shape[1] # or np.shape(velocity)[0] for DOFs</span>
</span></span></code></pre></div><pre><code>number of fine nodes:  289
</code></pre><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34; Snapshots generation&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>NumberOfSnapshots</span><span class=o>=</span><span class=mi>10</span> <span class=c1>#Training set</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#####  Create fluctuation parts for the snapshots #####</span>
</span></span><span class=line><span class=cl><span class=n>Re</span><span class=o>=</span><span class=mf>1.</span> <span class=c1>#first Reynolds number</span>
</span></span><span class=line><span class=cl><span class=n>AveragedSnapshots</span><span class=o>=</span><span class=n>FineBasis</span><span class=p>[</span><span class=s2>&#34;u&#34;</span><span class=p>]</span><span class=o>.</span><span class=n>zeros</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>FineSnapshots</span><span class=o>=</span><span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>NumberOfSnapshots</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>velocity</span><span class=p>,</span><span class=n>pressure</span><span class=o>=</span><span class=n>SolveCavityProblem</span><span class=p>(</span><span class=n>Re</span><span class=p>,</span><span class=n>FineMesh</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>AveragedSnapshots</span><span class=o>+=</span><span class=n>velocity</span>
</span></span><span class=line><span class=cl>    <span class=n>FineSnapshots</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>velocity</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>Re</span><span class=o>+=</span><span class=mi>45</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>AveragedSnapshots</span><span class=o>/=</span><span class=n>NumberOfSnapshots</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>NumberOfSnapshots</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>FineSnapshots</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>-=</span><span class=n>AveragedSnapshots</span>
</span></span><span class=line><span class=cl>    <span class=c1>#visualize_velocity(FineMesh,FineSnapshots[i])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@BilinearForm</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>massVelocity</span><span class=p>(</span><span class=n>u</span><span class=p>,</span> <span class=n>v</span><span class=p>,</span> <span class=n>_</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>u</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=n>v</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>+</span><span class=n>u</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>*</span> <span class=n>v</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=n>L2</span><span class=o>=</span><span class=n>massVelocity</span><span class=o>.</span><span class=n>assemble</span><span class=p>(</span><span class=n>FineBasis</span><span class=p>[</span><span class=s2>&#34;u&#34;</span><span class=p>])</span>
</span></span></code></pre></div><pre><code>Parameter nu: 1.0
Parameter nu: 0.021739130434782608
Parameter nu: 0.01098901098901099
Parameter nu: 0.007352941176470588
Parameter nu: 0.0055248618784530384
Parameter nu: 0.004424778761061947
Parameter nu: 0.0036900369003690036
Parameter nu: 0.0031645569620253164
Parameter nu: 0.002770083102493075
Parameter nu: 0.0024630541871921183
</code></pre><h2 id=1-snapshot-proper-orthogonal-decomposition-snapshot-pod>1. Snapshot Proper Orthogonal Decomposition (Snapshot-POD)</h2><p>One of the most popular algorithm is called &ldquo;Snapshot-POD&rdquo;.
See details in the paragraph &ldquo;OFFLINE STAGE&rdquo; on <a href=https://reducedbasis.github.io/docs/pod/ target=_blank rel=noopener>https://reducedbasis.github.io/docs/pod/</a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>### SNAPSHOT-POD </span>
</span></span><span class=line><span class=cl><span class=n>start_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>NumberOfModes</span><span class=o>=</span><span class=mi>6</span> <span class=c1>#tol</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;number of modes: &#34;</span><span class=p>,</span><span class=n>NumberOfModes</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># We first compute the correlation matrix C_ij = (u_i,u_j)</span>
</span></span><span class=line><span class=cl><span class=n>CorrelationMatrix</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=n>NumberOfSnapshots</span><span class=p>,</span> <span class=n>NumberOfSnapshots</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>snapshot1</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>FineSnapshots</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>MatVecProduct</span> <span class=o>=</span> <span class=n>L2</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>snapshot1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span><span class=p>,</span> <span class=n>snapshot2</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>FineSnapshots</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>i</span> <span class=o>&gt;=</span> <span class=n>j</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>CorrelationMatrix</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>MatVecProduct</span><span class=p>,</span> <span class=n>snapshot2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>CorrelationMatrix</span><span class=p>[</span><span class=n>j</span><span class=p>,</span> <span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>CorrelationMatrix</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#print(&#34;CorrelationMatrix&#34;,CorrelationMatrix)</span>
</span></span><span class=line><span class=cl><span class=c1># Then, we compute the eigenvalues/eigenvectors of C </span>
</span></span><span class=line><span class=cl><span class=n>EigenValues</span><span class=p>,</span> <span class=n>EigenVectors</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>eigh</span><span class=p>(</span><span class=n>CorrelationMatrix</span><span class=p>,</span> <span class=n>UPLO</span><span class=o>=</span><span class=s2>&#34;L&#34;</span><span class=p>)</span> <span class=c1># C eigenVectors=eigenValues eigenVectors</span>
</span></span><span class=line><span class=cl><span class=n>idx</span> <span class=o>=</span> <span class=n>EigenValues</span><span class=o>.</span><span class=n>argsort</span><span class=p>()[::</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=c1># sort the eigenvalues</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>TotEigenValues</span> <span class=o>=</span> <span class=n>EigenValues</span><span class=p>[</span><span class=n>idx</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>TotEigenVectors</span> <span class=o>=</span> <span class=n>EigenVectors</span><span class=p>[:,</span> <span class=n>idx</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>EigenValues</span><span class=o>=</span><span class=n>TotEigenValues</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=n>NumberOfModes</span><span class=p>]</span> <span class=c1># retrieve only the first eigenvalues and associated eigenvectors</span>
</span></span><span class=line><span class=cl><span class=n>EigenVectors</span><span class=o>=</span><span class=n>TotEigenVectors</span><span class=p>[:,</span><span class=mi>0</span><span class=p>:</span><span class=n>NumberOfModes</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;eigenvalues: &#34;</span><span class=p>,</span><span class=n>EigenValues</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>RIC</span><span class=o>=</span><span class=mi>1</span><span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>EigenValues</span><span class=p>)</span><span class=o>/</span><span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>TotEigenValues</span><span class=p>)</span> <span class=c1>#must be close to 0</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Relativ Information Content (must be close to 0):&#34;</span><span class=p>,</span><span class=n>RIC</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>#RIClist=[]</span>
</span></span><span class=line><span class=cl><span class=c1>#for i in range(len(EigenValues)):</span>
</span></span><span class=line><span class=cl><span class=c1>#    RIClist.append(1-np.sum(EigenValues[:i])/np.sum(TotEigenValues)) #must be close to 0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#project the snapshots onto the dominant eigenvectors and orthonormalize to retrieve the reduced basis</span>
</span></span><span class=line><span class=cl><span class=n>ChangeOfBasisMatrix</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=n>NumberOfModes</span><span class=p>,</span><span class=n>NumberOfSnapshots</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>NumberOfModes</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>ChangeOfBasisMatrix</span><span class=p>[</span><span class=n>j</span><span class=p>,:]</span> <span class=o>=</span> <span class=n>EigenVectors</span><span class=p>[:,</span><span class=n>j</span><span class=p>]</span><span class=o>/</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>EigenValues</span><span class=p>[</span><span class=n>j</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ReducedBasis</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>ChangeOfBasisMatrix</span><span class=p>,</span><span class=n>FineSnapshots</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>end_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>execution_time</span> <span class=o>=</span> <span class=n>end_time</span> <span class=o>-</span> <span class=n>start_time</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Temps d&#39;exécution : </span><span class=si>{</span><span class=n>execution_time</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2> secondes&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># orthogonality test:</span>
</span></span><span class=line><span class=cl><span class=c1>#for i in range(NumberOfModes):</span>
</span></span><span class=line><span class=cl><span class=c1>#    MatVecProduct = L2.dot(ReducedBasis[i])</span>
</span></span><span class=line><span class=cl><span class=c1>#    for j in range(NumberOfModes):    </span>
</span></span><span class=line><span class=cl><span class=c1>#        test = np.dot(MatVecProduct, ReducedBasis[j])</span>
</span></span><span class=line><span class=cl><span class=c1>#        print(&#34;i,j (&#34;,i,j,&#34;): &#34;,test)</span>
</span></span></code></pre></div><pre><code>number of modes:  6
eigenvalues:  [2.26782714e-02 2.92187702e-03 2.23860208e-04 1.86248477e-05
 2.17765951e-06 1.26997357e-07]
Relativ Information Content (must be close to 0): 1.9637265658012382e-07
Temps d'exécution : 0.020321 secondes
</code></pre><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;-----------------------------------&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;  Reduced basis accuracy           &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;-----------------------------------&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>### Offline Errors (H^1_0 and L2 norm)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>L2compressionErrors</span><span class=o>=</span><span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>H10compressionErrors</span><span class=o>=</span><span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>H10</span><span class=o>=</span><span class=n>vector_laplace</span><span class=o>.</span><span class=n>assemble</span><span class=p>(</span><span class=n>FineBasis</span><span class=p>[</span><span class=s1>&#39;u&#39;</span><span class=p>],</span><span class=n>nu</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>snap</span> <span class=ow>in</span> <span class=n>FineSnapshots</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>ExactSolution</span> <span class=o>=</span><span class=n>snap</span>
</span></span><span class=line><span class=cl>    <span class=n>CompressedSolutionU</span><span class=o>=</span> <span class=n>ExactSolution</span><span class=o>@</span><span class=p>(</span><span class=n>L2</span><span class=nd>@ReducedBasis.transpose</span><span class=p>())</span> <span class=c1>#snapshot compression</span>
</span></span><span class=line><span class=cl>    <span class=n>ReconstructedCompressedSolution</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>CompressedSolutionU</span><span class=p>,</span> <span class=n>ReducedBasis</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>norml2ExactSolution</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>ExactSolution</span><span class=o>@</span><span class=p>(</span><span class=n>L2</span><span class=nd>@ExactSolution</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>normh1ExactSolution</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>ExactSolution</span><span class=o>@</span><span class=p>(</span><span class=n>H10</span><span class=nd>@ExactSolution</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>t</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>ReconstructedCompressedSolution</span><span class=o>-</span><span class=n>ExactSolution</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>norml2ExactSolution</span> <span class=o>!=</span><span class=mi>0</span> <span class=ow>and</span> <span class=n>normh1ExactSolution</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>relL2Error</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>t</span><span class=nd>@L2@t</span><span class=p>)</span><span class=o>/</span><span class=n>norml2ExactSolution</span>
</span></span><span class=line><span class=cl>        <span class=n>relH10Error</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>t</span><span class=nd>@H10@t</span><span class=p>)</span><span class=o>/</span><span class=n>normh1ExactSolution</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>relL2Error</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>t</span><span class=nd>@L2@t</span><span class=p>)</span> <span class=c1>#np.linalg.norm(ReconstructedCompressedSolution-ExactSolution)</span>
</span></span><span class=line><span class=cl>        <span class=n>relH10Error</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>t</span><span class=nd>@H10@t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>L2compressionErrors</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>relL2Error</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>H10compressionErrors</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>relH10Error</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;L2 compression error =&#34;</span><span class=p>,</span> <span class=n>L2compressionErrors</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;H1 compression error =&#34;</span><span class=p>,</span> <span class=n>H10compressionErrors</span><span class=p>)</span>
</span></span></code></pre></div><pre><code>-----------------------------------
  Reduced basis accuracy           
-----------------------------------
L2 compression error = [1.3815241858207787e-05, 0.00010641993810965995, 0.0004383338831715788, 0.0012111542561164227, 0.001562010925688369, 0.000402636712347126, 0.0008616253925892823, 0.0001517154231303115, 0.000608298618732441, 0.0002466646884607357]
H1 compression error = [1.939956772653135e-05, 0.00014998512464928755, 0.0006436539912057455, 0.0018634474193047483, 0.0024692938629231388, 0.0006456797464323044, 0.0012552738118769562, 0.00023166001504574293, 0.0008375179988110922, 0.0003313113363450415]
</code></pre><h4 id=cost>cost</h4><p>If the matrix L2 is dense, then the cost of the correlation matrix computation is in $O(\mathcal{N}_h^2\ Ntrain^2)$ flops ($O(\mathcal{N}_h\ Ntrain^2)$ flops for a sparse L2 matrix), where $\mathcal{N}_h$ is the number of degrees of freedom of one snapshot and $Ntrain$ is the number of snapshots (L2.dot(snapshot1) is done in $O(\mathcal{N}_h^2$ within two imbricated forloops on the number of snapshots).
Then, the eigenproblem of the correlation matrix $C$ is solved in $O (\mathcal{Ntrain^3})$ flops.</p><h2 id=2-greedy-algorithm>2. Greedy algorithm</h2><p>A greedy algorithm is a procedure which aims at approximating each element of a compact set (here the manifold $S_h=Span\{u_h^0, \dots,u_h^n, \}$) in a Hilbert space $V_h$ by a subspace of properly selected elements of this compact set. The greedy procedure is a fast way to compute the modes by choosing some suitable parameters with respect to a criterion. At each Greedy iteration, the new RB parameter is chosen such that the corresponding snapshot is the worse approached by the previous reduced space.
The projection of a solution onto the reduced basis is given by $P^n(u)=\underset{i=1}{\overset{n}{\sum}} (u,\Phi_i)\Phi_i$.</p><ul><li><p>During the greedy algorithm, we first set $\Phi_0:=\frac{u_h^0}{\|u_h^0\|}$ (or any snapshots in the training set).</p></li><li><p>Then, we look for another snapshot $u_h^k$ in the training set that maximizes the error between itself and its projection onto the reduced basis, built from the first snapshot: $\frac{\|u_h^k - P^0(u_h^k) \|}{\|u_h^k\|}$, and we set $\Phi_1= \frac{u_h^k - P^0(u_h^k)}{\|u_h^k - P^0(u_h^k)\|}$.</p></li><li><p>We iterate until reaching a tolerance threshold on this error maximization, ensuring that any subsequent snapshot projection will result in a smaller error.</p></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>start_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>ReducedBasis</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=n>NumberOfModes</span><span class=p>,</span><span class=n>np</span><span class=o>.</span><span class=n>shape</span><span class=p>(</span><span class=n>velocity</span><span class=p>)[</span><span class=mi>0</span><span class=p>]))</span>
</span></span><span class=line><span class=cl><span class=n>SnapshotNorm</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>FineSnapshots</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=n>L2</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>FineSnapshots</span><span class=p>[</span><span class=mi>0</span><span class=p>])))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ReducedBasis</span><span class=p>[</span><span class=mi>0</span><span class=p>,:]</span><span class=o>=</span><span class=n>FineSnapshots</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>/</span><span class=n>SnapshotNorm</span> <span class=c1>#first (random) mode</span>
</span></span><span class=line><span class=cl><span class=n>ListReducedOrderBasis</span><span class=o>=</span><span class=p>[</span><span class=n>ReducedBasis</span><span class=p>[</span><span class=mi>0</span><span class=p>,:]]</span>
</span></span><span class=line><span class=cl><span class=n>ListeIndex</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=c1>#first snapshot </span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=n>MatrixBasisProduct</span><span class=o>=</span><span class=p>[</span><span class=n>L2</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>ListReducedOrderBasis</span><span class=p>[</span><span class=mi>0</span><span class=p>])]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>n</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=n>NumberOfModes</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>TestVector</span><span class=o>=</span><span class=nb>dict</span><span class=p>()</span> <span class=c1># dictionnary: to find the worst error between the snapshots and their projection on previous RB </span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>NumberOfSnapshots</span><span class=p>):</span> 
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=p>(</span><span class=n>j</span> <span class=ow>in</span> <span class=n>ListeIndex</span><span class=p>):</span> <span class=c1>#if index not already in the RB </span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>            <span class=c1>#w= u_j - sum_k (u_j,Phi_k) Phi_k</span>
</span></span><span class=line><span class=cl>            <span class=n>w</span><span class=o>=</span><span class=n>FineSnapshots</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=o>-</span><span class=nb>sum</span><span class=p>((</span><span class=n>bk</span><span class=o>*</span><span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>MatrixBasisProduct</span><span class=p>[</span><span class=n>k</span><span class=p>],</span><span class=n>FineSnapshots</span><span class=p>[</span><span class=n>j</span><span class=p>])</span> <span class=k>for</span> <span class=n>k</span><span class=p>,</span><span class=n>bk</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>ListReducedOrderBasis</span><span class=p>)))</span><span class=c1>#,axis=0)#potential vector to add in the reduced basis</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=n>NormL2W</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>((</span><span class=n>L2</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>w</span><span class=p>)),</span><span class=n>w</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>FineSnapshots</span><span class=p>[</span><span class=n>j</span><span class=p>],</span><span class=n>L2</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>FineSnapshots</span><span class=p>[</span><span class=n>j</span><span class=p>])))</span> <span class=o>&gt;</span> <span class=mf>1e-10</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>GreedyMaximumTest</span><span class=o>=</span><span class=n>NormL2W</span><span class=o>/</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>FineSnapshots</span><span class=p>[</span><span class=n>j</span><span class=p>],</span><span class=n>L2</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>FineSnapshots</span><span class=p>[</span><span class=n>j</span><span class=p>])))</span> <span class=c1>#we seek the max</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>GreedyMaximumTest</span><span class=o>=</span><span class=n>NormL2W</span> <span class=c1>#we seek the max</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=n>TestVector</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=o>=</span><span class=p>[</span><span class=n>GreedyMaximumTest</span><span class=p>,</span><span class=n>w</span><span class=p>,</span><span class=n>NormL2W</span><span class=p>]</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>    <span class=n>Index</span><span class=o>=</span><span class=nb>max</span><span class=p>(</span><span class=n>TestVector</span><span class=p>,</span> <span class=n>key</span> <span class=o>=</span> <span class=k>lambda</span> <span class=n>k</span><span class=p>:</span> <span class=n>TestVector</span><span class=p>[</span><span class=n>k</span><span class=p>][</span><span class=mi>0</span><span class=p>])</span> <span class=c1>#index of the snapshot used</span>
</span></span><span class=line><span class=cl>    <span class=n>ListeIndex</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>Index</span><span class=p>)</span> <span class=c1>#adding the corresponding j in the list</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>ListReducedOrderBasis</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>TestVector</span><span class=p>[</span><span class=n>Index</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span><span class=o>/</span><span class=n>TestVector</span><span class=p>[</span><span class=n>Index</span><span class=p>][</span><span class=mi>2</span><span class=p>])</span>  <span class=c1>#orthonormalization in L2</span>
</span></span><span class=line><span class=cl>    <span class=n>MatrixBasisProduct</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>L2</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>ListReducedOrderBasis</span><span class=p>[</span><span class=n>n</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=n>ReducedBasis</span><span class=p>[</span><span class=n>n</span><span class=p>,:]</span><span class=o>=</span><span class=n>ListReducedOrderBasis</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> 
</span></span><span class=line><span class=cl><span class=n>end_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>execution_time</span> <span class=o>=</span> <span class=n>end_time</span> <span class=o>-</span> <span class=n>start_time</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Temps d&#39;exécution : </span><span class=si>{</span><span class=n>execution_time</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2> secondes&#34;</span><span class=p>)</span>
</span></span></code></pre></div><pre><code>Temps d'exécution : 0.007447 secondes
</code></pre><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;-----------------------------------&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;  Reduced basis accuracy           &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;-----------------------------------&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>### Offline Errors (H^1_0 and L2 norm)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>L2compressionErrors</span><span class=o>=</span><span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>H10compressionErrors</span><span class=o>=</span><span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>H10</span><span class=o>=</span><span class=n>vector_laplace</span><span class=o>.</span><span class=n>assemble</span><span class=p>(</span><span class=n>FineBasis</span><span class=p>[</span><span class=s1>&#39;u&#39;</span><span class=p>],</span><span class=n>nu</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>snap</span> <span class=ow>in</span> <span class=n>FineSnapshots</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>ExactSolution</span> <span class=o>=</span><span class=n>snap</span>
</span></span><span class=line><span class=cl>    <span class=n>CompressedSolutionU</span><span class=o>=</span> <span class=n>ExactSolution</span><span class=o>@</span><span class=p>(</span><span class=n>L2</span><span class=nd>@ReducedBasis.transpose</span><span class=p>())</span> <span class=c1>#snapshot compression</span>
</span></span><span class=line><span class=cl>    <span class=n>ReconstructedCompressedSolution</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>CompressedSolutionU</span><span class=p>,</span> <span class=n>ReducedBasis</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>norml2ExactSolution</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>ExactSolution</span><span class=o>@</span><span class=p>(</span><span class=n>L2</span><span class=nd>@ExactSolution</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>normh1ExactSolution</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>ExactSolution</span><span class=o>@</span><span class=p>(</span><span class=n>H10</span><span class=nd>@ExactSolution</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>t</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>ReconstructedCompressedSolution</span><span class=o>-</span><span class=n>ExactSolution</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>norml2ExactSolution</span> <span class=o>!=</span><span class=mi>0</span> <span class=ow>and</span> <span class=n>normh1ExactSolution</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>relL2Error</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>t</span><span class=nd>@L2@t</span><span class=p>)</span><span class=o>/</span><span class=n>norml2ExactSolution</span>
</span></span><span class=line><span class=cl>        <span class=n>relH10Error</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>t</span><span class=nd>@H10@t</span><span class=p>)</span><span class=o>/</span><span class=n>normh1ExactSolution</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>relL2Error</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>t</span><span class=nd>@L2@t</span><span class=p>)</span> <span class=c1>#np.linalg.norm(ReconstructedCompressedSolution-ExactSolution)</span>
</span></span><span class=line><span class=cl>        <span class=n>relH10Error</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>t</span><span class=nd>@H10@t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>L2compressionErrors</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>relL2Error</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>H10compressionErrors</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>relH10Error</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;L2 compression error =&#34;</span><span class=p>,</span> <span class=n>L2compressionErrors</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;H1 compression error =&#34;</span><span class=p>,</span> <span class=n>H10compressionErrors</span><span class=p>)</span>
</span></span></code></pre></div><pre><code>-----------------------------------
  Reduced basis accuracy           
-----------------------------------
L2 compression error = [5.529786242990977e-15, 2.0540757465097742e-14, 0.004569484380782256, 9.279618605250094e-15, 1.9543010683101427e-14, 2.121598047069365e-14, 0.0017752632415230997, 0.0020589462893975245, 0.0012227664193758903, 1.5092299465667746e-14]
H1 compression error = [7.466170361331867e-15, 2.612819937191255e-14, 0.006316823621511566, 1.3728021953919329e-14, 2.8581942857475144e-14, 2.9972234706180816e-14, 0.0024665199322780984, 0.0027363713296409435, 0.001581469755596689, 1.9234340294589924e-14]
</code></pre><h4 id=cost-1>cost</h4><p>If the matrix L2 is dense, then the total cost is in $O(N \ \mathcal{N}_h^2\ Ntrain)$ flops ($O(N \ \mathcal{N}_h \ Ntrain)$ for a sparse matrix), where $\mathcal{N}_h$ is the number of degrees of freedom of one snapshot, $Ntrain$ is the number of snapshots and $N$ the number of modes.</p><p>Indeed, MatrixBasisProduct is computed in $O(\mathcal{N}_h^2)$ flops for a dense matrix.
We then have two imbricated forloops (in $O(N \ Ntrain)$):
The computation of $w$ is in $O(\mathcal{N}_h N)$ and its norm is in $O(\mathcal{N}_h^2)$ flops.</p><p>This cost is significantly lowered using a posteriori error estimates.</p><h2 id=3-rpod-random-pod>3. rPOD (random POD)</h2><p>see details in the last section below</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34; rSVD on the correlation matrix &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>start_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>NumberOfModes</span><span class=o>=</span><span class=mi>6</span> <span class=c1>#tol</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;number of modes: &#34;</span><span class=p>,</span><span class=n>NumberOfModes</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># C=U Sigma VT</span>
</span></span><span class=line><span class=cl><span class=c1># see detailed algorithm steps below (section 4)</span>
</span></span><span class=line><span class=cl><span class=n>U</span><span class=p>,</span> <span class=n>Sigma</span><span class=p>,</span> <span class=n>VT</span> <span class=o>=</span> <span class=n>randomized_svd</span><span class=p>(</span><span class=n>CorrelationMatrix</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                              <span class=n>n_oversamples</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=c1>#5 or 10 is better</span>
</span></span><span class=line><span class=cl>                              <span class=n>n_components</span><span class=o>=</span><span class=n>NumberOfModes</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                              <span class=n>n_iter</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span>  <span class=c1># power iteration</span>
</span></span><span class=line><span class=cl>                              <span class=c1>#power_iteration_normalizer=&#34;none&#34;, # or QR</span>
</span></span><span class=line><span class=cl>                              <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>  <span class=c1># Répétabilité</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>EigenValues</span><span class=o>=</span><span class=n>TotEigenValues</span>
</span></span><span class=line><span class=cl><span class=n>EigenVectors</span><span class=o>=</span><span class=n>VT</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Eigenvalues: &#34;</span><span class=p>,</span> <span class=n>EigenValues</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>#print(EigenVectors.shape)</span>
</span></span><span class=line><span class=cl><span class=n>RIClist</span><span class=o>=</span><span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>EigenValues</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=n>RIClist</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=mi>1</span><span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>EigenValues</span><span class=p>[:</span><span class=n>i</span><span class=p>])</span><span class=o>/</span><span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>Sigma</span><span class=p>))</span> <span class=c1>#must be close to 0</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;RIC: (&#34;</span><span class=p>,</span><span class=n>i</span><span class=p>,</span><span class=s2>&#34;)&#34;</span><span class=p>,</span> <span class=n>RIClist</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## same steps as in Snapshot-POD</span>
</span></span><span class=line><span class=cl><span class=n>ChangeOfBasisMatrix</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=n>NumberOfModes</span><span class=p>,</span><span class=n>NumberOfSnapshots</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>NumberOfModes</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>ChangeOfBasisMatrix</span><span class=p>[</span><span class=n>j</span><span class=p>,:]</span> <span class=o>=</span> <span class=n>EigenVectors</span><span class=p>[</span><span class=n>j</span><span class=p>,:]</span><span class=o>/</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>EigenValues</span><span class=p>[</span><span class=n>j</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ReducedBasis</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>ChangeOfBasisMatrix</span><span class=p>,</span><span class=n>FineSnapshots</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>#visualize_velocity(mesh,ReducedBasis[2])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>end_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>execution_time</span> <span class=o>=</span> <span class=n>end_time</span> <span class=o>-</span> <span class=n>start_time</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Temps d&#39;exécution : </span><span class=si>{</span><span class=n>execution_time</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2> secondes&#34;</span><span class=p>)</span>
</span></span></code></pre></div><pre><code>number of modes:  6
Eigenvalues:  [ 2.26782714e-02  2.92187702e-03  2.23860208e-04  1.86248477e-05
  2.17765951e-06  1.26997357e-07  4.93353135e-09  1.40613247e-10
  1.09557252e-12 -9.61608314e-19]
RIC: ( 0 ) 1.0
RIC: ( 1 ) 0.12252560668312185
RIC: ( 2 ) 0.009471476038941606
RIC: ( 3 ) 0.0008098105883218576
RIC: ( 4 ) 8.917246601403139e-05
RIC: ( 5 ) 4.913819319996016e-06
RIC: ( 6 ) -4.440892098500626e-16
RIC: ( 7 ) -1.9088965608204944e-07
RIC: ( 8 ) -1.9633030556853726e-07
RIC: ( 9 ) -1.9637269565997428e-07
Temps d'exécution : 0.003512 secondes
</code></pre><p>Now we can check for our reduced basis accuracy.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;-----------------------------------&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;  Reduced basis accuracy           &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;-----------------------------------&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>### Offline Errors (H^1_0 and L2 norm)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>L2compressionErrors</span><span class=o>=</span><span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>H10compressionErrors</span><span class=o>=</span><span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>H10</span><span class=o>=</span><span class=n>vector_laplace</span><span class=o>.</span><span class=n>assemble</span><span class=p>(</span><span class=n>FineBasis</span><span class=p>[</span><span class=s1>&#39;u&#39;</span><span class=p>],</span><span class=n>nu</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>snap</span> <span class=ow>in</span> <span class=n>FineSnapshots</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>ExactSolution</span> <span class=o>=</span><span class=n>snap</span>
</span></span><span class=line><span class=cl>    <span class=n>CompressedSolutionU</span><span class=o>=</span> <span class=n>ExactSolution</span><span class=o>@</span><span class=p>(</span><span class=n>L2</span><span class=nd>@ReducedBasis.transpose</span><span class=p>())</span> <span class=c1>#snapshot compression</span>
</span></span><span class=line><span class=cl>    <span class=n>ReconstructedCompressedSolution</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>CompressedSolutionU</span><span class=p>,</span> <span class=n>ReducedBasis</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>norml2ExactSolution</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>ExactSolution</span><span class=o>@</span><span class=p>(</span><span class=n>L2</span><span class=nd>@ExactSolution</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>normh1ExactSolution</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>ExactSolution</span><span class=o>@</span><span class=p>(</span><span class=n>H10</span><span class=nd>@ExactSolution</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>t</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>ReconstructedCompressedSolution</span><span class=o>-</span><span class=n>ExactSolution</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>norml2ExactSolution</span> <span class=o>!=</span><span class=mi>0</span> <span class=ow>and</span> <span class=n>normh1ExactSolution</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>relL2Error</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>t</span><span class=nd>@L2@t</span><span class=p>)</span><span class=o>/</span><span class=n>norml2ExactSolution</span>
</span></span><span class=line><span class=cl>        <span class=n>relH10Error</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>t</span><span class=nd>@H10@t</span><span class=p>)</span><span class=o>/</span><span class=n>normh1ExactSolution</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>relL2Error</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>t</span><span class=nd>@L2@t</span><span class=p>)</span> <span class=c1>#np.linalg.norm(ReconstructedCompressedSolution-ExactSolution)</span>
</span></span><span class=line><span class=cl>        <span class=n>relH10Error</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>t</span><span class=nd>@H10@t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>L2compressionErrors</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>relL2Error</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>H10compressionErrors</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>relH10Error</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;L2 compression error =&#34;</span><span class=p>,</span> <span class=n>L2compressionErrors</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;H1 compression error =&#34;</span><span class=p>,</span> <span class=n>H10compressionErrors</span><span class=p>)</span>
</span></span></code></pre></div><pre><code>-----------------------------------
  Reduced basis accuracy           
-----------------------------------
L2 compression error = [1.3815241858210751e-05, 0.00010641993810958985, 0.00043833388317143893, 0.001211154256116164, 0.0015620109256884352, 0.00040263671234692336, 0.0008616253925896097, 0.00015171542313003271, 0.0006082986187325006, 0.00024666468846097097]
H1 compression error = [1.9399567725164357e-05, 0.0001499851246557588, 0.0006436539912023722, 0.0018634474193020337, 0.0024692938629250977, 0.0006456797464365838, 0.0012552738118668722, 0.00023166001503718088, 0.000837517998819989, 0.00033131133634022204]
</code></pre><h4 id=cost-2>cost</h4><p>If the matrix L2 is dense, then the cost of the correlation matrix computation is in $O(\mathcal{N}_h^2\ Ntrain^2)$ flops where $\mathcal{N}_h$ is the number of degrees of freedom of one snapshot and $Ntrain$ is the number of snapshots.</p><p>Then, the dominant cost in the random SVD on the correlation matrix $C$ is in $O (Ntrain^2 (N+p))$ flops (cost of the multiplication of $C \in \mathbb{R}^{Ntrain \times Ntrain}$ by a gaussian matrix $\Omega \in \mathbb{R}^{Ntrain \times (N+p)}$).</p><h2 id=4-truncated-svd>4. Truncated SVD</h2><p>SVD and POD are very close algorithms:</p><p>The singular value decomposition (SVD) is widely used in low-rank approximation.
It consists in factorizing a matrix $\mathbf{A} \in \mathbb{R}^{m \times n}$ under the form $\mathbf{A} = \mathbf{U} \Sigma \mathbf{V}^T$ where $\mathbf{U} \in \mathbb{R}^{m \times m}$ and $\mathbf{V} \in \mathbb{R}^{n \times n}$ are unitary matrices with $\Sigma = diag(\sigma_1,...,\sigma_p) \in \mathbb{R}^{m \times n}$, and $ \sigma_1 \geq \sigma_2 \geq ··· \geq \sigma_p \geq 0$, with $p = $min$(m,n)$.</p><p>The $(\sigma_i)_{i=1,...,p}$ are called singular values of $\mathbf{A}$, $\mathbf{U}=[\Phi_1,\dots,\Phi_m]$ is made up of the left singular vectors of $\mathbf{A}$, whereas the elements of $\mathbf{V}=[\Psi_1,\dots,\Psi_m]$ are its right singular vectors, such that:
$\mathbf{A} \Phi_i=\sigma \Psi_i$.</p><p>The rank of a diagonal matrix is equal to the number of non zero diagonal terms, and rank($\mathbf{A}$)=rank($\Sigma$), such that if $\mathbf{A}$ has $r$ positive singular values, then rank($\mathbf{A}$) = $r$. We deduce that $\mathbf{A}$ can be written as the following sum:</p><p>$\mathbf{A} = \sum_{i=1}^r \sigma_i \Phi_i \Psi_i^T$.</p><p>In the POD, $\mathbf{A}^T \mathbf{A}$ is the correlation matrix and we use the fact that $\mathbf{A}^T \mathbf{A}= \mathbf{V} \Sigma^T \Sigma \mathbf{V}^T$.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>## SVD on the snapshots </span>
</span></span><span class=line><span class=cl><span class=n>start_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>FineSnapshots</span><span class=p>)</span><span class=o>.</span><span class=n>transpose</span><span class=p>()</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>U</span><span class=p>,</span> <span class=n>Sigma</span><span class=p>,</span> <span class=n>VT</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>svd</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>FineSnapshots</span><span class=p>)</span><span class=o>.</span><span class=n>transpose</span><span class=p>(),</span> <span class=n>full_matrices</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Select the first modes</span>
</span></span><span class=line><span class=cl><span class=n>ReducedBasis</span> <span class=o>=</span> <span class=n>U</span><span class=p>[:,</span> <span class=p>:</span><span class=n>NumberOfModes</span><span class=p>]</span>  <span class=c1># R^(Ndof x NumberOfModes)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Eigenvalues</span>
</span></span><span class=line><span class=cl><span class=n>EigenValues</span> <span class=o>=</span> <span class=n>Sigma</span><span class=p>[:</span><span class=n>NumberOfModes</span><span class=p>]</span> <span class=o>**</span> <span class=mi>2</span>  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;SVD Orthogonality:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>ReducedBasis</span><span class=o>.</span><span class=n>T</span> <span class=o>@</span> <span class=n>ReducedBasis</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># RIC</span>
</span></span><span class=line><span class=cl><span class=n>RIC</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>-</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>EigenValues</span><span class=p>)</span> <span class=o>/</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>Sigma</span> <span class=o>**</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Relative Information Content (must be close to 0):&#34;</span><span class=p>,</span> <span class=n>RIC</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>end_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>execution_time</span> <span class=o>=</span> <span class=n>end_time</span> <span class=o>-</span> <span class=n>start_time</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Temps d&#39;exécution : </span><span class=si>{</span><span class=n>execution_time</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2> secondes&#34;</span><span class=p>)</span>
</span></span></code></pre></div><pre><code>(2178, 10)
SVD Orthogonality:
[[ 1.00000000e+00  1.50920942e-16  7.45931095e-17  1.56125113e-17
  -9.97465999e-18  4.16333634e-17]
 [ 1.50920942e-16  1.00000000e+00  1.25767452e-16  5.20417043e-17
   3.81639165e-17  2.42861287e-17]
 [ 7.45931095e-17  1.25767452e-16  1.00000000e+00  3.66026653e-16
   3.81639165e-17 -3.88686479e-17]
 [ 1.56125113e-17  5.20417043e-17  3.66026653e-16  1.00000000e+00
  -2.18575158e-16 -4.85722573e-17]
 [-9.97465999e-18  3.81639165e-17  3.81639165e-17 -2.18575158e-16
   1.00000000e+00  3.20923843e-17]
 [ 4.16333634e-17  2.42861287e-17 -3.88686479e-17 -4.85722573e-17
   3.20923843e-17  1.00000000e+00]]
Relative Information Content (must be close to 0): 2.0033294889643116e-07
Temps d'exécution : 0.003572 secondes
</code></pre><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;-----------------------------------&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;  Reduced basis accuracy           &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;-----------------------------------&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>### Offline Errors (H^1_0 and L2 norm)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>L2compressionErrors</span><span class=o>=</span><span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>H10compressionErrors</span><span class=o>=</span><span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>H10</span><span class=o>=</span><span class=n>vector_laplace</span><span class=o>.</span><span class=n>assemble</span><span class=p>(</span><span class=n>FineBasis</span><span class=p>[</span><span class=s1>&#39;u&#39;</span><span class=p>],</span><span class=n>nu</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>snap</span> <span class=ow>in</span> <span class=n>FineSnapshots</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>ExactSolution</span> <span class=o>=</span><span class=n>snap</span>
</span></span><span class=line><span class=cl>    <span class=n>CompressedSolutionU</span><span class=o>=</span> <span class=n>ReducedBasis</span><span class=o>.</span><span class=n>transpose</span><span class=p>()</span><span class=nd>@ExactSolution</span> <span class=c1>#snapshot compression</span>
</span></span><span class=line><span class=cl>    <span class=n>ReconstructedCompressedSolution</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>CompressedSolutionU</span><span class=p>,</span> <span class=n>ReducedBasis</span><span class=o>.</span><span class=n>transpose</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>norml2ExactSolution</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>ExactSolution</span><span class=o>@</span><span class=p>(</span><span class=n>L2</span><span class=nd>@ExactSolution</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>normh1ExactSolution</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>ExactSolution</span><span class=o>@</span><span class=p>(</span><span class=n>H10</span><span class=nd>@ExactSolution</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>t</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>ReconstructedCompressedSolution</span><span class=o>-</span><span class=n>ExactSolution</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>norml2ExactSolution</span> <span class=o>!=</span><span class=mi>0</span> <span class=ow>and</span> <span class=n>normh1ExactSolution</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>relL2Error</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>t</span><span class=nd>@L2@t</span><span class=p>)</span><span class=o>/</span><span class=n>norml2ExactSolution</span>
</span></span><span class=line><span class=cl>        <span class=n>relH10Error</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>t</span><span class=nd>@H10@t</span><span class=p>)</span><span class=o>/</span><span class=n>normh1ExactSolution</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>relL2Error</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>t</span><span class=nd>@L2@t</span><span class=p>)</span> <span class=c1>#np.linalg.norm(ReconstructedCompressedSolution-ExactSolution)</span>
</span></span><span class=line><span class=cl>        <span class=n>relH10Error</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>t</span><span class=nd>@H10@t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>L2compressionErrors</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>relL2Error</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>H10compressionErrors</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>relH10Error</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;L2 compression error =&#34;</span><span class=p>,</span> <span class=n>L2compressionErrors</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;H1 compression error =&#34;</span><span class=p>,</span> <span class=n>H10compressionErrors</span><span class=p>)</span>
</span></span></code></pre></div><pre><code>-----------------------------------
  Reduced basis accuracy           
-----------------------------------
L2 compression error = [1.3839653232122614e-05, 0.00010655139750967699, 0.00043876659941552253, 0.0012119568854371354, 0.0015619237548005866, 0.0004033969722890684, 0.0008613698384691759, 0.00015201310598890686, 0.0006078993200356156, 0.0002463245710069301]
H1 compression error = [1.941939702097461e-05, 0.00015005819467710422, 0.0006437531425080919, 0.0018633145654439185, 0.002466401029440625, 0.0006467412928887584, 0.001254080490147989, 0.00023202553425037264, 0.0008359907910302726, 0.0003306576959726763]
</code></pre><h4 id=cost-3>cost</h4><p>The dominant cost in the SVD on the snapshot matrix $A$ is in $O (N_h \times Ntrain^2)$ flops.</p><h2 id=5-random-svd-rsvd>5. Random SVD (rSVD)</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>## rSVD on the snapshots</span>
</span></span><span class=line><span class=cl><span class=n>start_time</span><span class=o>=</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>U</span><span class=p>,</span> <span class=n>Sigma</span><span class=p>,</span> <span class=n>VT</span> <span class=o>=</span> <span class=n>randomized_svd</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>FineSnapshots</span><span class=p>)</span><span class=o>.</span><span class=n>transpose</span><span class=p>(),</span> 
</span></span><span class=line><span class=cl>                              <span class=n>n_components</span><span class=o>=</span><span class=n>NumberOfModes</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                              <span class=n>n_iter</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                              <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ReducedBasis</span> <span class=o>=</span> <span class=n>U</span><span class=p>[:,</span> <span class=p>:</span><span class=n>NumberOfModes</span><span class=p>]</span>  <span class=c1># (Ndof x NumberOfModes)</span>
</span></span><span class=line><span class=cl><span class=n>EigenValues</span> <span class=o>=</span> <span class=n>Sigma</span><span class=p>[:</span><span class=n>NumberOfModes</span><span class=p>]</span> <span class=o>**</span> <span class=mi>2</span>  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;rSVD Orthogonality:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>ReducedBasis</span><span class=o>.</span><span class=n>T</span> <span class=o>@</span> <span class=n>ReducedBasis</span><span class=p>)</span>  <span class=c1># Devrait être ≈ Identité</span>
</span></span><span class=line><span class=cl><span class=n>end_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>execution_time</span> <span class=o>=</span> <span class=n>end_time</span> <span class=o>-</span> <span class=n>start_time</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Temps d&#39;exécution : </span><span class=si>{</span><span class=n>execution_time</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2> secondes&#34;</span><span class=p>)</span>
</span></span></code></pre></div><pre><code>rSVD Orthogonality:
[[ 1.00000000e+00 -1.21430643e-17 -9.02056208e-17 -3.29597460e-17
  -3.51281504e-17 -3.81639165e-17]
 [-1.21430643e-17  1.00000000e+00 -9.02056208e-17  1.04083409e-17
  -5.89805982e-17  6.59194921e-17]
 [-9.02056208e-17 -9.02056208e-17  1.00000000e+00  1.26634814e-16
   6.93889390e-18  1.75098651e-17]
 [-3.29597460e-17  1.04083409e-17  1.26634814e-16  1.00000000e+00
   0.00000000e+00 -6.67868538e-17]
 [-3.51281504e-17 -5.89805982e-17  6.93889390e-18  0.00000000e+00
   1.00000000e+00  6.15826834e-17]
 [-3.81639165e-17  6.59194921e-17  1.75098651e-17 -6.67868538e-17
   6.15826834e-17  1.00000000e+00]]
Temps d'exécution : 0.009150 secondes
</code></pre><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;-----------------------------------&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;  Reduced basis accuracy           &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;-----------------------------------&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>### Offline Errors (H^1_0 and L2 norm)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>L2compressionErrors</span><span class=o>=</span><span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>H10compressionErrors</span><span class=o>=</span><span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>H10</span><span class=o>=</span><span class=n>vector_laplace</span><span class=o>.</span><span class=n>assemble</span><span class=p>(</span><span class=n>FineBasis</span><span class=p>[</span><span class=s1>&#39;u&#39;</span><span class=p>],</span><span class=n>nu</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>snap</span> <span class=ow>in</span> <span class=n>FineSnapshots</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>ExactSolution</span> <span class=o>=</span><span class=n>snap</span>
</span></span><span class=line><span class=cl>    <span class=n>CompressedSolutionU</span><span class=o>=</span> <span class=n>ReducedBasis</span><span class=o>.</span><span class=n>transpose</span><span class=p>()</span><span class=nd>@ExactSolution</span> <span class=c1>#snapshot compression</span>
</span></span><span class=line><span class=cl>    <span class=n>ReconstructedCompressedSolution</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>CompressedSolutionU</span><span class=p>,</span> <span class=n>ReducedBasis</span><span class=o>.</span><span class=n>transpose</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>norml2ExactSolution</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>ExactSolution</span><span class=o>@</span><span class=p>(</span><span class=n>L2</span><span class=nd>@ExactSolution</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>normh1ExactSolution</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>ExactSolution</span><span class=o>@</span><span class=p>(</span><span class=n>H10</span><span class=nd>@ExactSolution</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>t</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>ReconstructedCompressedSolution</span><span class=o>-</span><span class=n>ExactSolution</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>norml2ExactSolution</span> <span class=o>!=</span><span class=mi>0</span> <span class=ow>and</span> <span class=n>normh1ExactSolution</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>relL2Error</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>t</span><span class=nd>@L2@t</span><span class=p>)</span><span class=o>/</span><span class=n>norml2ExactSolution</span>
</span></span><span class=line><span class=cl>        <span class=n>relH10Error</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>t</span><span class=nd>@H10@t</span><span class=p>)</span><span class=o>/</span><span class=n>normh1ExactSolution</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>relL2Error</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>t</span><span class=nd>@L2@t</span><span class=p>)</span> <span class=c1>#np.linalg.norm(ReconstructedCompressedSolution-ExactSolution)</span>
</span></span><span class=line><span class=cl>        <span class=n>relH10Error</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>t</span><span class=nd>@H10@t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>L2compressionErrors</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>relL2Error</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>H10compressionErrors</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>relH10Error</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;L2 compression error =&#34;</span><span class=p>,</span> <span class=n>L2compressionErrors</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;H1 compression error =&#34;</span><span class=p>,</span> <span class=n>H10compressionErrors</span><span class=p>)</span>
</span></span></code></pre></div><pre><code>-----------------------------------
  Reduced basis accuracy           
-----------------------------------
L2 compression error = [1.3839653232129974e-05, 0.00010655139750966657, 0.00043876659941556253, 0.001211956885437101, 0.0015619237548005456, 0.0004033969722890735, 0.0008613698384691697, 0.00015201310598888105, 0.0006078993200356165, 0.0002463245710069679]
H1 compression error = [1.941939702088054e-05, 0.00015005819467713285, 0.00064375314250792, 0.001863314565444008, 0.00246640102944091, 0.0006467412928888026, 0.0012540804901480403, 0.00023202553425050946, 0.0008359907910302515, 0.00033065769597253166]
</code></pre><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>## DETAILS on rSVD:</span>
</span></span><span class=line><span class=cl><span class=n>start_time</span><span class=o>=</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=c1># if q is small (1 or 2) no power_iteration_normalizer is required but otherwise add QR decomposition at each step (or LU...)</span>
</span></span><span class=line><span class=cl><span class=c1>## rSVD on the snapshots</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>S</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>FineSnapshots</span><span class=p>)</span><span class=o>.</span><span class=n>transpose</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>rng</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>default_rng</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>  <span class=c1># for reproductibility purposes</span>
</span></span><span class=line><span class=cl><span class=n>Omega</span> <span class=o>=</span> <span class=n>rng</span><span class=o>.</span><span class=n>standard_normal</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=p>(</span><span class=n>NumberOfSnapshots</span><span class=p>,</span> <span class=n>NumberOfModes</span><span class=p>))</span>  <span class=c1># random matrix #coud also add oversamples</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># First we project the snapshots on a smaller random space of size Nt*N</span>
</span></span><span class=line><span class=cl><span class=c1># Step 1 : random projection</span>
</span></span><span class=line><span class=cl><span class=c1>#Y = (S@S.T)@(S@S.T)@S@ Omega  </span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># or with Power iterations to enhance the precision of the approximation of dominant singular vectors (with orthonormalization at each step).</span>
</span></span><span class=line><span class=cl><span class=n>q</span><span class=o>=</span><span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=n>Y</span><span class=o>=</span><span class=n>S</span><span class=nd>@Omega</span> <span class=c1>#init</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>q</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>Y</span> <span class=o>=</span> <span class=n>S</span> <span class=o>@</span> <span class=p>(</span><span class=n>S</span><span class=o>.</span><span class=n>T</span> <span class=o>@</span> <span class=n>Y</span><span class=p>)</span>  <span class=c1># Itérations de puissance</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>q</span><span class=o>&gt;</span><span class=mi>2</span><span class=p>:</span> 
</span></span><span class=line><span class=cl>        <span class=n>Q</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>qr</span><span class=p>(</span><span class=n>Y</span><span class=p>)</span>  <span class=c1># QR Orthonormalization </span>
</span></span><span class=line><span class=cl>        <span class=n>Y</span> <span class=o>=</span> <span class=n>Q</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Step 2 : Orthonormalization (QR)</span>
</span></span><span class=line><span class=cl><span class=n>Q</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>qr</span><span class=p>(</span><span class=n>Y</span><span class=p>)</span>  <span class=c1># (m, k) #S=Q Q^T S</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Step 3  : Reduced projection</span>
</span></span><span class=line><span class=cl><span class=n>B</span> <span class=o>=</span> <span class=n>Q</span><span class=o>.</span><span class=n>T</span> <span class=o>@</span> <span class=n>S</span>  <span class=c1># (k, N)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Step 4 : SVD on B</span>
</span></span><span class=line><span class=cl><span class=n>U_tilde</span><span class=p>,</span> <span class=n>S</span><span class=p>,</span> <span class=n>VT</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>svd</span><span class=p>(</span><span class=n>B</span><span class=p>,</span> <span class=n>full_matrices</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ReducedBasis</span><span class=o>=</span><span class=n>Q</span><span class=nd>@U_tilde</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>end_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>execution_time</span> <span class=o>=</span> <span class=n>end_time</span> <span class=o>-</span> <span class=n>start_time</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Temps d&#39;exécution : </span><span class=si>{</span><span class=n>execution_time</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2> secondes&#34;</span><span class=p>)</span>
</span></span></code></pre></div><pre><code>Temps d'exécution : 0.003637 secondes
</code></pre><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;-----------------------------------&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;  Reduced basis accuracy           &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;-----------------------------------&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>### Offline Errors (H^1_0 and L2 norm)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>L2compressionErrors</span><span class=o>=</span><span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>H10compressionErrors</span><span class=o>=</span><span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>H10</span><span class=o>=</span><span class=n>vector_laplace</span><span class=o>.</span><span class=n>assemble</span><span class=p>(</span><span class=n>FineBasis</span><span class=p>[</span><span class=s1>&#39;u&#39;</span><span class=p>],</span><span class=n>nu</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>snap</span> <span class=ow>in</span> <span class=n>FineSnapshots</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>ExactSolution</span> <span class=o>=</span><span class=n>snap</span>
</span></span><span class=line><span class=cl>    <span class=n>CompressedSolutionU</span><span class=o>=</span> <span class=n>ReducedBasis</span><span class=o>.</span><span class=n>transpose</span><span class=p>()</span><span class=nd>@ExactSolution</span> <span class=c1>#snapshot compression</span>
</span></span><span class=line><span class=cl>    <span class=n>ReconstructedCompressedSolution</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>CompressedSolutionU</span><span class=p>,</span> <span class=n>ReducedBasis</span><span class=o>.</span><span class=n>transpose</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>norml2ExactSolution</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>ExactSolution</span><span class=o>@</span><span class=p>(</span><span class=n>L2</span><span class=nd>@ExactSolution</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>normh1ExactSolution</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>ExactSolution</span><span class=o>@</span><span class=p>(</span><span class=n>H10</span><span class=nd>@ExactSolution</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>t</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>ReconstructedCompressedSolution</span><span class=o>-</span><span class=n>ExactSolution</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>norml2ExactSolution</span> <span class=o>!=</span><span class=mi>0</span> <span class=ow>and</span> <span class=n>normh1ExactSolution</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>relL2Error</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>t</span><span class=nd>@L2@t</span><span class=p>)</span><span class=o>/</span><span class=n>norml2ExactSolution</span>
</span></span><span class=line><span class=cl>        <span class=n>relH10Error</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>t</span><span class=nd>@H10@t</span><span class=p>)</span><span class=o>/</span><span class=n>normh1ExactSolution</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>relL2Error</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>t</span><span class=nd>@L2@t</span><span class=p>)</span> <span class=c1>#np.linalg.norm(ReconstructedCompressedSolution-ExactSolution)</span>
</span></span><span class=line><span class=cl>        <span class=n>relH10Error</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>t</span><span class=nd>@H10@t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>L2compressionErrors</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>relL2Error</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>H10compressionErrors</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>relH10Error</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;L2 compression error =&#34;</span><span class=p>,</span> <span class=n>L2compressionErrors</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;H1 compression error =&#34;</span><span class=p>,</span> <span class=n>H10compressionErrors</span><span class=p>)</span>
</span></span></code></pre></div><pre><code>-----------------------------------
  Reduced basis accuracy           
-----------------------------------
L2 compression error = [1.3839650641800041e-05, 0.00010655138025831539, 0.00043876654776895215, 0.0012119568161507801, 0.0015619237983524252, 0.00040339690992188625, 0.0008613698745842613, 0.00015201308612810389, 0.0006078993568913044, 0.0002463245965823324]
H1 compression error = [1.9419393408006165e-05, 0.0001500581703820479, 0.0006437530670056677, 0.0018633144607903833, 0.002466401103775472, 0.0006467412024139285, 0.0012540805465273642, 0.00023202550603323933, 0.0008359908438539881, 0.0003306577308801652]
</code></pre><h4 id=cost-4>cost</h4><p>The dominant cost in the random SVD on the snapshot matrix $A$ is in $O (N \times Ntrain \times N_h)$ flops (in the power iterations) if $N_h>Ntrain$.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python></code></pre></div></div><time class="mt-12 mb-8 block text-xs text-gray-500 ltr:text-right rtl:text-left dark:text-gray-400" datetime=2024-12-13T10:19:20.000Z><span>Last updated on</span>
Dec 13, 2024</time><div class="container mx-auto prose prose-slate lg:prose-xl dark:prose-invert mt-5"><div class="max-w-prose print:hidden"><section class="flex flex-row flex-wrap justify-center pt-4 text-xl"><a target=_blank rel=noopener class="m-1 rounded-md bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral-300 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://twitter.com/intent/tweet?url=https%3A%2F%2Freducedbasis.github.io%2Fpost%2Foffline%2F&amp;text=Offline+part" title=X aria-label=X id=share-link-x><svg style="height:1em" viewBox="0 0 512 512"><path fill="currentcolor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg>
</a><a target=_blank rel=noopener class="m-1 rounded-md bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral-300 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Freducedbasis.github.io%2Fpost%2Foffline%2F&amp;t=Offline+part" title=Facebook aria-label=Facebook id=share-link-facebook><svg style="height:1em" viewBox="0 0 24 24"><path fill="currentcolor" d="M22 12c0-5.52-4.48-10-10-10S2 6.48 2 12c0 4.84 3.44 8.87 8 9.8V15H8v-3h2V9.5C10 7.57 11.57 6 13.5 6H16v3h-2c-.55.0-1 .45-1 1v2h3v3h-3v6.95c5.05-.5 9-4.76 9-9.95z"/></svg>
</a><a target=_blank rel=noopener class="m-1 rounded-md bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral-300 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="mailto:?subject=Offline%20part&amp;body=https%3A%2F%2Freducedbasis.github.io%2Fpost%2Foffline%2F" title=Email aria-label=Email id=share-link-email><svg style="height:1em" viewBox="0 0 24 24"><path fill="none" stroke="currentcolor" stroke-linecap="round" stroke-width="1.5" d="M16.5 12a4.5 4.5.0 11-9 0 4.5 4.5.0 019 0zm0 0c0 1.657 1.007 3 2.25 3S21 13.657 21 12a9 9 0 10-2.636 6.364M16.5 12V8.25"/></svg>
</a><a target=_blank rel=noopener class="m-1 rounded-md bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral-300 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Freducedbasis.github.io%2Fpost%2Foffline%2F&amp;title=Offline+part" title=LinkedIn aria-label=LinkedIn id=share-link-linkedin><svg style="height:1em" height="1em" viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</a><a target=_blank rel=noopener class="m-1 rounded-md bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral-300 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="whatsapp://send?text=Offline+part%20https%3A%2F%2Freducedbasis.github.io%2Fpost%2Foffline%2F" title=WhatsApp aria-label=WhatsApp id=share-link-whatsapp><svg style="height:1em" viewBox="0 0 256 256" fill="currentcolor"><path d="m187.58 144.84-32-16a8 8 0 00-8 .5l-14.69 9.8a40.55 40.55.0 01-16-16l9.8-14.69a8 8 0 00.5-8l-16-32A8 8 0 00104 64a40 40 0 00-40 40 88.1 88.1.0 0088 88 40 40 0 0040-40 8 8 0 00-4.42-7.16zM152 176a72.08 72.08.0 01-72-72 24 24 0 0119.29-23.54l11.48 23L101 118a8 8 0 00-.73 7.51 56.47 56.47.0 0030.15 30.15A8 8 0 00138 155l14.61-9.74 23 11.48A24 24 0 01152 176zM128 24A104 104 0 0036.18 176.88l-11.35 34.05a16 16 0 0020.24 20.24l34.05-11.35A104 104 0 10128 24zm0 192a87.87 87.87.0 01-44.06-11.81 8 8 0 00-6.54-.67L40 216l12.47-37.4a8 8 0 00-.66-6.54A88 88 0 11128 216z"/></svg></a></section><div class="flex pt-12 pb-4"><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Authors</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300"></div><div class="text-2xl sm:text-lg pt-1"><div class="flex flex-wrap text-neutral-500 dark:text-neutral-300"><a class="pr-2 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400" style=will-change:transform href=mailto:reducedbases@gmail.com aria-label=At-Symbol><svg style="height:1em" viewBox="0 0 24 24"><path fill="none" stroke="currentcolor" stroke-linecap="round" stroke-width="1.5" d="M16.5 12a4.5 4.5.0 11-9 0 4.5 4.5.0 019 0zm0 0c0 1.657 1.007 3 2.25 3S21 13.657 21 12a9 9 0 10-2.636 6.364M16.5 12V8.25"/></svg></a></div></div></div></div><div class="pt-1 no-prose w-full"><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex flex-col md:flex-row flex-nowrap justify-between gap-5 pt-2"><div><a class="group flex no-underline" href=/post/pbdw/><span class="mt-[-0.3rem] me-2 text-neutral-700 transition-transform group-hover:-translate-x-[2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"><span class="ltr:inline rtl:hidden">&larr;</span></span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">My Post</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">Dec 13, 2024</span></span></a></div><div><a class="group flex text-right no-underline" href=/post/rsvd/><span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">random Singular Value Decomposition</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">Dec 13, 2024
</span></span><span class="mt-[-0.3rem] ms-2 text-neutral-700 transition-transform group-hover:-translate-x-[2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"><span class=ltr:inline>&rarr;</span></span></a></div></div></div></div></div></main></article></div></div><div class=page-footer><footer class="container mx-auto flex flex-col justify-items-center text-sm leading-6 mt-24 mb-4 text-slate-700 dark:text-slate-200"><p class="powered-by text-center">Thanks</p><p class="powered-by footer-license-icons"><a href=https://creativecommons.org/licenses/by-nc-nd/4.0 rel="noopener noreferrer" target=_blank aria-label="Creative Commons"><i class="fab fa-creative-commons fa-2x" aria-hidden=true></i>
<i class="fab fa-creative-commons-by fa-2x" aria-hidden=true></i>
<i class="fab fa-creative-commons-nc fa-2x" aria-hidden=true></i>
<i class="fab fa-creative-commons-nd fa-2x" aria-hidden=true></i></a></p><p class="powered-by text-center">Published with <a href="https://hugoblox.com/?utm_campaign=poweredby" target=_blank rel=noopener>Hugo Blox Builder</a> — the free, <a href=https://github.com/HugoBlox/hugo-blox-builder target=_blank rel=noopener>open source</a> website builder that empowers creators.</p></footer></div></body></html>